initialized server_access
initialized global_tracker
initialized ploptions
initialized data_cubby
initialized plot_manager
[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=all[0m
[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=br[0m
[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bt[0m
[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bn[0m
[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bmag[0m
[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=pmag[0m
initialized mag_rtn_4sa class
[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=all[0m
[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=br[0m
[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=bt[0m
[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=bn[0m
[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=bmag[0m
[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=pmag[0m
initialized mag_rtn class
[35m[ZARR] Using plot_options: data_type=mag_SC_4sa, class=mag_sc_4sa, subclass=all[0m
[35m[ZARR] Using plot_options: data_type=mag_SC_4sa, class=mag_sc_4sa, subclass=bx[0m
[35m[ZARR] Using plot_options: data_type=mag_SC_4sa, class=mag_sc_4sa, subclass=by[0m
[35m[ZARR] Using plot_options: data_type=mag_SC_4sa, class=mag_sc_4sa, subclass=bz[0m
[35m[ZARR] Using plot_options: data_type=mag_SC_4sa, class=mag_sc_4sa, subclass=bmag[0m
[35m[ZARR] Using plot_options: data_type=mag_SC_4sa, class=mag_sc_4sa, subclass=pmag[0m
initialized mag_sc_4sa class
[35m[ZARR] Using plot_options: data_type=mag_SC, class=mag_sc, subclass=all[0m
[35m[ZARR] Using plot_options: data_type=mag_SC, class=mag_sc, subclass=bx[0m
[35m[ZARR] Using plot_options: data_type=mag_SC, class=mag_sc, subclass=by[0m
[35m[ZARR] Using plot_options: data_type=mag_SC, class=mag_sc, subclass=bz[0m
[35m[ZARR] Using plot_options: data_type=mag_SC, class=mag_sc, subclass=bmag[0m
[35m[ZARR] Using plot_options: data_type=mag_SC, class=mag_sc, subclass=pmag[0m
initialized mag_sc class
[35m[ZARR] Using plot_options: data_type=spe_sf0_pad, class=epad, subclass=strahl[0m
[35m[ZARR] Using plot_options: data_type=spe_sf0_pad, class=epad, subclass=centroids[0m
initialized epad class
[35m[ZARR] Using plot_options: data_type=spe_af0_pad, class=epad_hr, subclass=strahl[0m
[35m[ZARR] Using plot_options: data_type=spe_af0_pad, class=epad_hr, subclass=centroids[0m
initialized epad_hr class
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=t_par[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=t_perp[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=anisotropy[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=v_alfven[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=v_sw[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=m_alfven[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=beta_ppar[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=beta_pperp[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=pressure_ppar[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=pressure_pperp[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=pressure[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=density[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=temperature[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=bmag[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=vr[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=vt[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=vn[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=energy_flux[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=theta_flux[0m
[35m[ZARR] Using plot_options: data_type=spi_sf00_l3_mom, class=proton, subclass=phi_flux[0m
initialized proton class
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=t_par[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=t_perp[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=anisotropy[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=v_alfven[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=v_sw[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=m_alfven[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=beta_ppar[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=beta_pperp[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=pressure_ppar[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=pressure_pperp[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=pressure[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=density[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=temperature[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=bmag[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=vr[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=vt[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=vn[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=energy_flux[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=theta_flux[0m
[35m[ZARR] Using plot_options: data_type=spi_af00_L3_mom, class=proton_hr, subclass=phi_flux[0m
initialized proton_hr class
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=qz_p[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vsw_mach_pfits[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=beta_ppar_pfits[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=beta_pperp_pfits[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=ham_param[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=np1[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=np2[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=n_tot[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=np2_np1_ratio[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_x[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_y[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_z[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_mag[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_x[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_y[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_z[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_mag[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vdrift[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vdrift_abs[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vdrift_va_pfits[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Trat1[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Trat2[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Trat_tot[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tpar1[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tpar2[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tpar_tot[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tperp1[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tperp2[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tperp_tot[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Temp_tot[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=abs_qz_p[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=chi_p[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=chi_p_norm[0m
[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=valfven_pfits[0m
initialized proton_fits class
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamstring[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_30s[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_og_30s[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_2m[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_og_2m[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_20m[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_90m[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_4h[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_og_4h[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=trat_ham[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=trat_ham_og[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=ham_core_drift[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=ham_core_drift_va[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Nham_div_Ncore[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Nham_div_Ncore_og[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Nham_div_Ntot[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Nham_div_Ntot_og[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Tperp_ham_div_core[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Tperp_ham_div_core_og[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Tperprat_driftva_hc[0m
[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Tperprat_driftva_hc_og[0m
initialized ham_class
🔉 initialized audifier

Importing libraries, this may take a moment. Hold tight... 

✅ Imported standard libraries and utilities.
✅ Imported numpy, pandas, and scipy libraries.
✅ Imported matplotlib libraries.
✅ Imported cdflib, BeautifulSoup, requests, dateutil, and datetime libraries.
[35m[ZARR] [ZarrStorage.__init__] Initializing with base_dir=./data_cubby[0m
[35m[ZARR] [ZarrStorage.__init__] Directory created: ./data_cubby[0m

🤖 Plotbot Initialized
✨ Showdahodo initialized
Positional Data Helper Initialized
📈📉 Multiplot Initialized
[94m   Version: 2025_05_03_v1.97[0m
[94m   Commit: start ZARR_integration branch: v1.97: begin metadata-driven Zarr refactor [2025_05_03_v1.97][0m

[94m🤖 Plotbot Initialized[0m
Test-only mode enabled
============================= test session starts ==============================
platform darwin -- Python 3.12.4, pytest-7.4.4, pluggy-1.5.0 -- /opt/anaconda3/envs/plotbot_env/bin/python3.12
cachedir: .pytest_cache
rootdir: /Users/robertalexander/GitHub/Plotbot
configfile: pytest.ini
collecting ... ham_class __getattr__ triggered for: _pytestfixturefunction
mag_rtn getattr helper!
'_pytestfixturefunction' is not a recognized attribute, friend!
Try one of these: all, br, bt, bn, bmag, pmag
mag_rtn_4sa getattr helper!
'_pytestfixturefunction' is not a recognized attribute, friend!
Try one of these: all, br, bt, bn, bmag, pmag
proton_fits __getattr__ triggered for: _pytestfixturefunction
ham_class __getattr__ triggered for: __bases__
ham_class __getattr__ triggered for: __test__
proton_fits __getattr__ triggered for: __bases__
proton_fits __getattr__ triggered for: __test__
mag_rtn getattr helper!
'__bases__' is not a recognized attribute, friend!
Try one of these: all, br, bt, bn, bmag, pmag
mag_rtn getattr helper!
'__test__' is not a recognized attribute, friend!
Try one of these: all, br, bt, bn, bmag, pmag
mag_rtn_4sa getattr helper!
'__bases__' is not a recognized attribute, friend!
Try one of these: all, br, bt, bn, bmag, pmag
mag_rtn_4sa getattr helper!
'__test__' is not a recognized attribute, friend!
Try one of these: all, br, bt, bn, bmag, pmag
collected 12 items

tests/test_stardust.py::test_stardust_plotbot_basic Debug mode enabled

=== Testing plotbot (stardust) ===
🔵 PHASE 1: Calling plotbot with Br, Bt, Bn (stardust)
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: br
Returning br component
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: bt
Returning bt component
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: bn
Returning bn component
[35m[ZARR] TRACE: get_data function entry point[0m
[35m[ZARR] INPUT: trange=['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000'], variables=(plot_manager(None, dtype=object), plot_manager(None, dtype=object), plot_manager(None, dtype=object))[0m
Variable type: <class 'plotbot.plot_manager.plot_manager'>, name: None
[35m[ZARR] [get_data] required_data_types: {'mag_RTN_4sa'}[0m
[35m[ZARR] 
Processing Data Type: mag_RTN_4sa...[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

[35m[ZARR] [get_data] mag_RTN_4sa: needs_import=True, needs_refresh=True[0m
[35m[ZARR] [get_data] Import/Refresh logic triggered for mag_RTN_4sa[0m
[35m[ZARR] [load_data] Called for data_type=mag_RTN_4sa, trange=['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000'][0m
[35m[ZARR] [load_data] file_time_format=daily[0m
[35m[ZARR] [_find_zarr_paths] Called for data_type=mag_RTN_4sa, start_time=2020-04-09 06:00:00+00:00, end_time=2020-04-09 07:00:00+00:00, file_time_format=daily[0m
[35m[ZARR] [_get_zarr_path] Called for data_type=mag_RTN_4sa, timestamp=2020-04-09 00:00:00+00:00, file_time_format=daily[0m
[35m[ZARR] [_get_zarr_path] Returning path[0m
[35m[ZARR] [_find_zarr_paths] Returning paths: ['./data_cubby/mag_rtn_4sa/2020/04/09.zarr'][0m
[35m[ZARR] [load_data] zarr_paths: ['./data_cubby/mag_rtn_4sa/2020/04/09.zarr'][0m
[35m[ZARR] [load_data] Loading 1 Zarr stores[0m
[35m[ZARR] [load_data] Looping through zarr_paths[0m
[35m[ZARR] Zarr data not available for mag_RTN_4sa, proceeding with normal download...[0m
[35m[ZARR] Server mode for mag_RTN_4sa: dynamic[0m
[35m[ZARR] Attempting SPDF download (dynamic mode) for mag_RTN_4sa...[0m
Attempting SPDF download for mag_RTN_4sa in range ['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000']
Checking for Berkeley/SPDF case conflicts before SPDF download for mag_RTN_4sa...
Attempting SPDF check/download (no_update=False) for mag_rtn_4_sa_per_cyc...
[35m[ZARR] SPDF download result (dynamic mode) for mag_RTN_4sa: Success[0m
[35m[ZARR] [get_data] Calling import_data_function for mag_RTN_4sa[0m
Import data function called
Input trange: ['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000']

Importing data for UTC time range: ['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000']

=== Starting import for mag_RTN_4sa (CDF) ===
daterange called with start_date=2020-04-09 06:00:00+00:00, end_date=2020-04-09 07:00:00+00:00
End date has time component, using full day: 2020-04-09
Converted start_date to date: 2020-04-09
Will generate 1 dates
Yielding date: 2020-04-09
Found 1 unique CDF files to process.

Processing CDF file: psp_data/fields/l2/mag_rtn_4_per_cycle/2020/psp_fld_l2_mag_rtn_4_sa_per_cyc_20200409_v02.cdf
Successfully opened CDF file
Using time variable: epoch_mag_RTN_4_Sa_per_Cyc
File time range (TT2000): 639662469236127872 to 639717989418817280
Reading full time data array...
Read 254151 time points
Time indices: 98877 to 115356
Extracted 16479 time points within requested range

Reading variable: psp_fld_l2_mag_RTN_4_Sa_per_Cyc
Raw data shape: (16479, 3)
Successfully stored data slice for psp_fld_l2_mag_RTN_4_Sa_per_Cyc

Concatenating CDF data...
  Concatenated psp_fld_l2_mag_RTN_4_Sa_per_Cyc (Shape: (16479, 3))

Total CDF data points after concatenation: 16479
[35m[ZARR] [get_data] import_data_function returned: Success[0m
[35m[ZARR] Updating tracker for mag_RTN_4sa[0m
[35m[ZARR] [get_data] Calling update on mag_rtn_4sa with data_obj for mag_RTN_4sa[0m
[CUBBY] 
=== Update Debug ===
[CUBBY] Starting mag_rtn_4sa_class update...
[CUBBY] Stored all state: {}
[CUBBY] Stored br state: {}
[CUBBY] Stored bt state: {}
[CUBBY] Stored bn state: {}
[CUBBY] Stored bmag state: {}
[CUBBY] Stored pmag state: {}
Setting attribute: time with value: [639684069351521408 639684069569974784 639684069788428160 ...
 639687668605894656 639687668824348032 639687669042801408]
Setting attribute: datetime_array with value: ['2020-04-09T06:00:00.167521408' '2020-04-09T06:00:00.385974784'
 '2020-04-09T06:00:00.604428160' ... '2020-04-09T06:59:59.421894656'
 '2020-04-09T06:59:59.640348032' '2020-04-09T06:59:59.858801408']
self.datetime_array type after conversion: {type(self.datetime_array)}
First element type: {type(self.datetime_array[0])}
Setting attribute: field with value: [[-1.2780722  1.9562279 -1.6147578]
 [-1.2070351  1.9074465 -1.653989 ]
 [-1.0547991  1.9341055 -1.6223421]
 ...
 [-1.6029835  1.7710884 -3.213096 ]
 [-1.6011271  1.8615494 -3.1834538]
 [-1.7720017  1.8375443 -3.1456287]]
Setting attribute: raw_data with value: {'all': [array([-1.2780722, -1.2070351, -1.0547991, ..., -1.6029835, -1.6011271,
       -1.7720017], dtype=float32), array([1.9562279, 1.9074465, 1.9341055, ..., 1.7710884, 1.8615494,
       1.8375443], dtype=float32), array([-1.6147578, -1.653989 , -1.6223421, ..., -3.213096 , -3.1834538,
       -3.1456287], dtype=float32)], 'br': array([-1.2780722, -1.2070351, -1.0547991, ..., -1.6029835, -1.6011271,
       -1.7720017], dtype=float32), 'bt': array([1.9562279, 1.9074465, 1.9341055, ..., 1.7710884, 1.8615494,
       1.8375443], dtype=float32), 'bn': array([-1.6147578, -1.653989 , -1.6223421, ..., -3.213096 , -3.1834538,
       -3.1456287], dtype=float32), 'bmag': array([2.8403764, 2.798386 , 2.7359385, ..., 4.003785 , 4.020367 ,
       4.051116 ], dtype=float32), 'pmag': array([0.00321005, 0.00311584, 0.00297833, ..., 0.00637825, 0.00643119,
       0.00652994], dtype=float32)}

Debug - Data Arrays:
Time array shape: {self.time.shape}
Field data shape: (16479, 3)
First TT2000 time: 639684069351521408

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=all[0m
Setting attribute: all with value: [[-1.2780722 -1.2070351 -1.0547991 ... -1.6029835 -1.6011271 -1.7720017]
 [ 1.9562279  1.9074465  1.9341055 ...  1.7710884  1.8615494  1.8375443]
 [-1.6147578 -1.653989  -1.6223421 ... -3.213096  -3.1834538 -3.1456287]]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=br[0m
Setting attribute: br with value: [-1.2780722 -1.2070351 -1.0547991 ... -1.6029835 -1.6011271 -1.7720017]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bt[0m
Setting attribute: bt with value: [1.9562279 1.9074465 1.9341055 ... 1.7710884 1.8615494 1.8375443]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bn[0m
Setting attribute: bn with value: [-1.6147578 -1.653989  -1.6223421 ... -3.213096  -3.1834538 -3.1456287]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bmag[0m
Setting attribute: bmag with value: [2.8403764 2.798386  2.7359385 ... 4.003785  4.020367  4.051116 ]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=pmag[0m
Setting attribute: pmag with value: [0.00321005 0.00311584 0.00297833 ... 0.00637825 0.00643119 0.00652994]
[CUBBY] Restoring saved state...
[CUBBY] Restored all state: {}
[CUBBY] Restored br state: {}
[CUBBY] Restored bt state: {}
[CUBBY] Restored bn state: {}
[CUBBY] Restored bmag state: {}
[CUBBY] Restored pmag state: {}
[CUBBY] === End Update Debug ===

[CUBBY] 
=== Stashing Debug (INSIDE DATA CUBBY)===
[CUBBY] Stashing with identifier: mag_rtn_4sa
[CUBBY] Attributes before stash:

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - all: [-1.2780722 -1.2070351 -1.0547991 -1.1240557 -1.1451013 -1.0937773
 -1.1076237 -1.1961842 -1.2171344 -1.1899039]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - bmag: [2.8403764 2.798386  2.7359385 2.7496045 2.669894  2.6765587 2.7306733
 2.7386606 2.7866673 2.9104137]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - bn: [-1.6147578 -1.653989  -1.6223421 -1.6406322 -1.5929232 -1.6348606
 -1.6434181 -1.6241328 -1.631358  -1.7246184]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - br: [-1.2780722 -1.2070351 -1.0547991 -1.1240557 -1.1451013 -1.0937773
 -1.1076237 -1.1961842 -1.2171344 -1.1899039]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - bt: [1.9562279 1.9074465 1.9341055 1.898723  1.8109866 1.8151718 1.8785428
 1.8524573 1.9033576 2.019982 ]...
[CUBBY] - calculate_variables: <bound method mag_rtn_4sa_class.calculate_variables of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>
[CUBBY] - datetime: []...
[CUBBY] - datetime_array: ['2020-04-09T06:00:00.167521408' '2020-04-09T06:00:00.385974784'
 '2020-04-09T06:00:00.604428160' '2020-04-09T06:00:00.822881280'
 '2020-04-09T06:00:01.041334784' '2020-04-09T06:00:01.259788160'
 '2020-04-09T06:00:01.478241280' '2020-04-09T06:00:01.696694784'
 '2020-04-09T06:00:01.915148160' '2020-04-09T06:00:02.133601280']...
[CUBBY] - field: [-1.2780722  1.9562279 -1.6147578 -1.2070351  1.9074465 -1.653989
 -1.0547991  1.9341055 -1.6223421 -1.1240557]...
[CUBBY] - get_subclass: <bound method mag_rtn_4sa_class.get_subclass of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - pmag: [0.00321005 0.00311584 0.00297833 0.00300816 0.00283627 0.00285045
 0.00296688 0.00298426 0.0030898  0.00337031]...
[CUBBY] - raw_data: {'all': [array([-1.2780722, -1.2070351, -1.0547991, ..., -1.6029835, -1.6011271,
       -1.7720017], dtype=float32), array([1.9562279, 1.9074465, 1.9341055, ..., 1.7710884, 1.8615494,
       1.8375443], dtype=float32), array([-1.6147578, -1.653989 , -1.6223421, ..., -3.213096 , -3.1834538,
       -3.1456287], dtype=float32)], 'br': array([-1.2780722, -1.2070351, -1.0547991, ..., -1.6029835, -1.6011271,
       -1.7720017], dtype=float32), 'bt': array([1.9562279, 1.9074465, 1.9341055, ..., 1.7710884, 1.8615494,
       1.8375443], dtype=float32), 'bn': array([-1.6147578, -1.653989 , -1.6223421, ..., -3.213096 , -3.1834538,
       -3.1456287], dtype=float32), 'bmag': array([2.8403764, 2.798386 , 2.7359385, ..., 4.003785 , 4.020367 ,
       4.051116 ], dtype=float32), 'pmag': array([0.00321005, 0.00311584, 0.00297833, ..., 0.00637825, 0.00643119,
       0.00652994], dtype=float32)}
[CUBBY] - set_ploptions: <bound method mag_rtn_4sa_class.set_ploptions of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>
[CUBBY] - time: [639684069351521408 639684069569974784 639684069788428160
 639684070006881280 639684070225334784 639684070443788160
 639684070662241280 639684070880694784 639684071099148160
 639684071317601280]...
[CUBBY] - update: <bound method mag_rtn_4sa_class.update of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>
[CUBBY] Stored in class_registry: mag_rtn_4sa
[CUBBY] === End Stashing Debug (LEAVING DATA CUBBY)===

Successfully updated and stored in data_cubby
[35m[ZARR] [get_data] Update completed for mag_rtn_4sa[0m
[35m[ZARR] [get_data] Calling store_data for mag_RTN_4sa[0m
[35m[ZARR] [store_data] Called for data_type=mag_RTN_4sa, trange=['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000'][0m
[35m[ZARR] Storing data for mag_RTN_4sa[0m
[35m[ZARR] datetime_array length: 16479[0m
[35m[ZARR] raw_data keys: ['all', 'br', 'bt', 'bn', 'bmag', 'pmag'][0m
[35m[ZARR] [store_data] file_time_format=daily[0m
[35m[ZARR] [store_data] Creating data_vars from class_instance.raw_data[0m
[STORE] var_name: br, data shape: (16479,), dims: ['time']
[STORE] var_name: bt, data shape: (16479,), dims: ['time']
[STORE] var_name: bn, data shape: (16479,), dims: ['time']
[STORE] var_name: bmag, data shape: (16479,), dims: ['time']
[STORE] var_name: pmag, data shape: (16479,), dims: ['time']
[STORE] datetime_array: ['2020-04-09T06:00:00.167521408' '2020-04-09T06:00:00.385974784'
 '2020-04-09T06:00:00.604428160' '2020-04-09T06:00:00.822881280'
 '2020-04-09T06:00:01.041334784'] ... total: 16479
[STORE] Dataset variables: ['br', 'bt', 'bn', 'bmag', 'pmag']
[35m[ZARR] [_get_zarr_path] Called for data_type=mag_RTN_4sa, timestamp=2020-04-09T06:00:00.167521408, file_time_format=daily[0m
[35m[ZARR] [_get_zarr_path] Returning path[0m
[35m[ZARR] Checking if Zarr file exists: True[0m
[35m[ZARR] Zarr directory contents: ['time', 'pmag', 'zarr.json', 'bt', 'bn', 'br', 'bmag'][0m
[35m[ZARR] [store_data] Data saved to Zarr store[0m
[35m[ZARR] [get_data] store_data result for mag_RTN_4sa: Success[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: br
Returning br component

DEBUG:
var: [-1.2780722 -1.2070351 -1.0547991 ... -1.6029835 -1.6011271 -1.7720017]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2020-04-09T06:00:00.167521408
Time range: 2020-04-09T06:00:00.167521408 to 2020-04-09T06:59:59.858801408
var.data type: <class 'numpy.ndarray'>
var.data shape: (16479,)

Variable verification for mag_rtn_4sa.br:
Plot attributes example:
- Color: forestgreen
- Y-label: B (nT)
- Legend: $B_R$
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: bt
Returning bt component

DEBUG:
var: [1.9562279 1.9074465 1.9341055 ... 1.7710884 1.8615494 1.8375443]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2020-04-09T06:00:00.167521408
Time range: 2020-04-09T06:00:00.167521408 to 2020-04-09T06:59:59.858801408
var.data type: <class 'numpy.ndarray'>
var.data shape: (16479,)

Variable verification for mag_rtn_4sa.bt:
Plot attributes example:
- Color: orange
- Y-label: B (nT)
- Legend: $B_T$
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: bn
Returning bn component

DEBUG:
var: [-1.6147578 -1.653989  -1.6223421 ... -3.213096  -3.1834538 -3.1456287]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2020-04-09T06:00:00.167521408
Time range: 2020-04-09T06:00:00.167521408 to 2020-04-09T06:59:59.858801408
var.data type: <class 'numpy.ndarray'>
var.data shape: (16479,)

Variable verification for mag_rtn_4sa.bn:
Plot attributes example:
- Color: dodgerblue
- Y-label: B (nT)
- Legend: $B_N$
🔵 PHASE 2: Verifying plotbot call completed (stardust)
--- Explicitly closed figure 1 in finally block ---
PASSED
tests/test_stardust.py::test_stardust_multiplot_basic 
=== Testing multiplot (stardust) ===
🔵 PHASE 1: Setting up multiplot options (stardust)
🔵 PHASE 2: Defining plot data and calling multiplot (stardust)
Using time axis (positional mapping not requested)

=== Starting Multiplot Function ===
[35m[ZARR] TRACE: get_data function entry point[0m
[35m[ZARR] INPUT: trange=['2020-04-09/06:00:00.000000', '2020-04-09/07:00:00.000000'], variables=(plot_manager([-1.2780722, -1.2070351, -1.0547991, ..., -1.6029835,
              -1.6011271, -1.7720017], dtype=float32),)[0m
Variable type: <class 'plotbot.plot_manager.plot_manager'>, name: None
[35m[ZARR] [get_data] required_data_types: {'mag_RTN_4sa'}[0m
[35m[ZARR] 
Processing Data Type: mag_RTN_4sa...[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

[35m[ZARR] [get_data] mag_RTN_4sa: needs_import=False, needs_refresh=False[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: br
Returning br component
[35m[ZARR] TRACE: get_data function entry point[0m
[35m[ZARR] INPUT: trange=['2020-04-09/06:00:00.000000', '2020-04-09/07:00:00.000000'], variables=(plot_manager([1.9562279, 1.9074465, 1.9341055, ..., 1.7710884, 1.8615494,
              1.8375443], dtype=float32),)[0m
Variable type: <class 'plotbot.plot_manager.plot_manager'>, name: None
[35m[ZARR] [get_data] required_data_types: {'mag_RTN_4sa'}[0m
[35m[ZARR] 
Processing Data Type: mag_RTN_4sa...[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

[35m[ZARR] [get_data] mag_RTN_4sa: needs_import=False, needs_refresh=False[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: bt
Returning bt component
[35m[ZARR] TRACE: get_data function entry point[0m
[35m[ZARR] INPUT: trange=['2020-04-09/06:00:00.000000', '2020-04-09/07:00:00.000000'], variables=(plot_manager([-1.6147578, -1.653989 , -1.6223421, ..., -3.213096 ,
              -3.1834538, -3.1456287], dtype=float32),)[0m
Variable type: <class 'plotbot.plot_manager.plot_manager'>, name: None
[35m[ZARR] [get_data] required_data_types: {'mag_RTN_4sa'}[0m
[35m[ZARR] 
Processing Data Type: mag_RTN_4sa...[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

[35m[ZARR] [get_data] mag_RTN_4sa: needs_import=False, needs_refresh=False[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: bn
Returning bn component
Accessing axis ax1
Creating new axis options for ax1
[AxisOptions Setter] Set y_limit to None for instance ID 13139647312
Panel 1: Using auto-scaling.
Panel 1: ylim after auto-scaling: (-2.259500578045845, 0.20103372633457184)
Accessing axis ax1
Using existing axis options for ax1
Accessing axis ax2
Creating new axis options for ax2
[AxisOptions Setter] Set y_limit to None for instance ID 13140203264
Panel 2: Using auto-scaling.
Panel 2: ylim after auto-scaling: (-1.2742030143737793, 3.0842759132385256)
Accessing axis ax2
Using existing axis options for ax2
Accessing axis ax3
Creating new axis options for ax3
[AxisOptions Setter] Set y_limit to None for instance ID 13420796608
Panel 3: Using auto-scaling.
Panel 3: ylim after auto-scaling: (-3.869315800070763, 0.6840170592069625)
Accessing axis ax3
Using existing axis options for ax3
Added title to top axis with pad=21.0
Applied x_label_pad=8 to axis 2
Performing final enforced check to hide tick labels on non-bottom panels for single-x-axis mode
Forcibly hid all tick labels for panel 0
Forcibly hid all tick labels for panel 1
=== Multiplot Complete ===

DEBUG: Type of axs returned by multiplot: <class 'list'>
🔵 PHASE 3: Verifying multiplot output (stardust)
--- Explicitly closed multiplot figure 1 in finally block ---
PASSED
tests/test_stardust.py::test_stardust_showdahodo_basic 
=== Testing showdahodo (stardust) ===
🔵 PHASE 1: Calling showdahodo with Bt vs Br (stardust)
[35m[ZARR] TRACE: get_data function entry point[0m
[35m[ZARR] INPUT: trange=['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000'], variables=(plot_manager([1.9562279, 1.9074465, 1.9341055, ..., 1.7710884, 1.8615494,
              1.8375443], dtype=float32), plot_manager([-1.2780722, -1.2070351, -1.0547991, ..., -1.6029835,
              -1.6011271, -1.7720017], dtype=float32))[0m
Variable type: <class 'plotbot.plot_manager.plot_manager'>, name: None
[35m[ZARR] [get_data] required_data_types: {'mag_RTN_4sa'}[0m
[35m[ZARR] 
Processing Data Type: mag_RTN_4sa...[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

[35m[ZARR] [get_data] mag_RTN_4sa: needs_import=False, needs_refresh=False[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: bt
Returning bt component
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: br
Returning br component
DEBUG: Original lengths - time1: 16479, time2: 16479, color: 0, var3: 0
Data lengths - time1: 16479, time2: 16479, color: N/A, var3: N/A
🔵 PHASE 2: Verifying showdahodo output (stardust)
--- Explicitly closed showdahodo figure 1 in finally block ---
PASSED
tests/test_stardust.py::test_dynamic_mode_fallback_logic_integrated 
--- [Fixture] Saving original config.data_server: 'dynamic' ---
Debug mode enabled
--- Testing dynamic mode fallback logic via get_data call ---
Set config.data_server = 'dynamic'
Patching SPDF at 'plotbot.get_data.download_spdf_data'
Patching Berkeley at 'plotbot.get_data.download_berkeley_data'
Calling get_data(...) with mocks active...
[35m[ZARR] TRACE: get_data function entry point[0m
[35m[ZARR] INPUT: trange=['2024-12-24/06:00:00.000', '2024-12-24/07:30:00.000'], variables=(plot_manager([-1.2780722, -1.2070351, -1.0547991, ..., -1.6029835,
              -1.6011271, -1.7720017], dtype=float32),)[0m
Variable type: <class 'plotbot.plot_manager.plot_manager'>, name: None
[35m[ZARR] [get_data] required_data_types: {'mag_RTN_4sa'}[0m
[35m[ZARR] 
Processing Data Type: mag_RTN_4sa...[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

[35m[ZARR] [get_data] mag_RTN_4sa: needs_import=True, needs_refresh=True[0m
[35m[ZARR] [get_data] Import/Refresh logic triggered for mag_RTN_4sa[0m
[35m[ZARR] [load_data] Called for data_type=mag_RTN_4sa, trange=['2024-12-24/06:00:00.000', '2024-12-24/07:30:00.000'][0m
[35m[ZARR] [load_data] file_time_format=daily[0m
[35m[ZARR] [_find_zarr_paths] Called for data_type=mag_RTN_4sa, start_time=2024-12-24 06:00:00+00:00, end_time=2024-12-24 07:30:00+00:00, file_time_format=daily[0m
[35m[ZARR] [_get_zarr_path] Called for data_type=mag_RTN_4sa, timestamp=2024-12-24 00:00:00+00:00, file_time_format=daily[0m
[35m[ZARR] [_get_zarr_path] Returning path[0m
[35m[ZARR] [_find_zarr_paths] Returning paths: ['./data_cubby/mag_rtn_4sa/2024/12/24.zarr'][0m
[35m[ZARR] [load_data] zarr_paths: ['./data_cubby/mag_rtn_4sa/2024/12/24.zarr'][0m
[35m[ZARR] [load_data] Loading 1 Zarr stores[0m
[35m[ZARR] [load_data] Looping through zarr_paths[0m
[35m[ZARR] Zarr data not available for mag_RTN_4sa, proceeding with normal download...[0m
[35m[ZARR] Server mode for mag_RTN_4sa: dynamic[0m
[35m[ZARR] Attempting SPDF download (dynamic mode) for mag_RTN_4sa...[0m
--- Mock SPDF download called, returning [] (failure) ---
[35m[ZARR] SPDF download result (dynamic mode) for mag_RTN_4sa: Failed[0m
[35m[ZARR] SPDF download failed/incomplete for mag_RTN_4sa, falling back to Berkeley...[0m
--- Mock Berkeley download called ---
[35m[ZARR] Berkeley fallback download result for mag_RTN_4sa: Success[0m
[35m[ZARR] [get_data] Calling import_data_function for mag_RTN_4sa[0m
Import data function called
Input trange: ['2024-12-24/06:00:00.000', '2024-12-24/07:30:00.000']

Importing data for UTC time range: ['2024-12-24/06:00:00.000', '2024-12-24/07:30:00.000']

=== Starting import for mag_RTN_4sa (CDF) ===
daterange called with start_date=2024-12-24 06:00:00+00:00, end_date=2024-12-24 07:30:00+00:00
End date has time component, using full day: 2024-12-24
Converted start_date to date: 2024-12-24
Will generate 1 dates
Yielding date: 2024-12-24
Found 1 unique CDF files to process.

Processing CDF file: psp_data/fields/l2/mag_rtn_4_per_cycle/2024/psp_fld_l2_mag_RTN_4_Sa_per_Cyc_20241224_v00.cdf
Successfully opened CDF file
Using time variable: epoch_mag_RTN_4_Sa_per_Cyc
File time range (TT2000): 788270469275001600 to 788356869137569152
Reading full time data array...
Read 395506 time points
Time indices: 98877 to 123596
Extracted 24719 time points within requested range

Reading variable: psp_fld_l2_mag_RTN_4_Sa_per_Cyc
Raw data shape: (24719, 3)
Successfully stored data slice for psp_fld_l2_mag_RTN_4_Sa_per_Cyc

Concatenating CDF data...
  Concatenated psp_fld_l2_mag_RTN_4_Sa_per_Cyc (Shape: (24719, 3))

Total CDF data points after concatenation: 24719
[35m[ZARR] [get_data] import_data_function returned: Success[0m
[35m[ZARR] Updating tracker for mag_RTN_4sa[0m
[35m[ZARR] [get_data] Calling update on mag_rtn_4sa with data_obj for mag_RTN_4sa[0m
[CUBBY] 
=== Update Debug ===
[CUBBY] Starting mag_rtn_4sa_class update...
[CUBBY] Stored all state: {}
[CUBBY] Stored br state: {}
[CUBBY] Stored bt state: {}
[CUBBY] Stored bn state: {}
[CUBBY] Stored bmag state: {}
[CUBBY] Stored pmag state: {}
Setting attribute: time with value: [788292069390289408 788292069608742656 788292069827196160 ...
 788297468711524864 788297468929978240 788297469148431744]
Setting attribute: datetime_array with value: ['2024-12-24T06:00:00.206289408' '2024-12-24T06:00:00.424742656'
 '2024-12-24T06:00:00.643196160' ... '2024-12-24T07:29:59.527524864'
 '2024-12-24T07:29:59.745978240' '2024-12-24T07:29:59.964431744']
self.datetime_array type after conversion: {type(self.datetime_array)}
First element type: {type(self.datetime_array[0])}
Setting attribute: field with value: [[-1126.1879    359.4798   -468.0768 ]
 [-1120.4971    352.0624   -484.3329 ]
 [-1119.7444    351.09058  -486.28036]
 ...
 [-1381.3326    173.14677   154.47873]
 [-1389.332     146.52287   108.6285 ]
 [-1392.3956    121.04443    99.726  ]]
Setting attribute: raw_data with value: {'all': [array([-1126.1879, -1120.4971, -1119.7444, ..., -1381.3326, -1389.332 ,
       -1392.3956], dtype=float32), array([359.4798 , 352.0624 , 351.09058, ..., 173.14677, 146.52287,
       121.04443], dtype=float32), array([-468.0768 , -484.3329 , -486.28036, ...,  154.47873,  108.6285 ,
         99.726  ], dtype=float32)], 'br': array([-1126.1879, -1120.4971, -1119.7444, ..., -1381.3326, -1389.332 ,
       -1392.3956], dtype=float32), 'bt': array([359.4798 , 352.0624 , 351.09058, ..., 173.14677, 146.52287,
       121.04443], dtype=float32), 'bn': array([-468.0768 , -484.3329 , -486.28036, ...,  154.47873,  108.6285 ,
         99.726  ], dtype=float32), 'bmag': array([1271.464 , 1270.4487, 1270.2601, ..., 1400.6868, 1401.2539,
       1401.2004], dtype=float32), 'pmag': array([643.2329 , 642.2061 , 642.0154 , ..., 780.6245 , 781.2568 ,
       781.19714], dtype=float32)}

Debug - Data Arrays:
Time array shape: {self.time.shape}
Field data shape: (24719, 3)
First TT2000 time: 788292069390289408

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=all[0m
Setting attribute: all with value: [[-1126.1879  -1120.4971  -1119.7444  ... -1381.3326  -1389.332
  -1392.3956 ]
 [  359.4798    352.0624    351.09058 ...   173.14677   146.52287
    121.04443]
 [ -468.0768   -484.3329   -486.28036 ...   154.47873   108.6285
     99.726  ]]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=br[0m
Setting attribute: br with value: [-1126.1879 -1120.4971 -1119.7444 ... -1381.3326 -1389.332  -1392.3956]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bt[0m
Setting attribute: bt with value: [359.4798  352.0624  351.09058 ... 173.14677 146.52287 121.04443]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bn[0m
Setting attribute: bn with value: [-468.0768  -484.3329  -486.28036 ...  154.47873  108.6285    99.726  ]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bmag[0m
Setting attribute: bmag with value: [1271.464  1270.4487 1270.2601 ... 1400.6868 1401.2539 1401.2004]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=pmag[0m
Setting attribute: pmag with value: [643.2329  642.2061  642.0154  ... 780.6245  781.2568  781.19714]
[CUBBY] Restoring saved state...
[CUBBY] Restored all state: {}
[CUBBY] Restored br state: {}
[CUBBY] Restored bt state: {}
[CUBBY] Restored bn state: {}
[CUBBY] Restored bmag state: {}
[CUBBY] Restored pmag state: {}
[CUBBY] === End Update Debug ===

[CUBBY] 
=== Stashing Debug (INSIDE DATA CUBBY)===
[CUBBY] Stashing with identifier: mag_rtn_4sa
[CUBBY] Attributes before stash:

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - all: [-1126.1879 -1120.4971 -1119.7444 -1119.4563 -1111.5925 -1121.3168
 -1119.3052 -1119.8706 -1130.8518 -1117.2026]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - bmag: [1271.464  1270.4487 1270.2601 1270.2078 1269.4834 1269.5675 1268.769
 1270.1661 1269.085  1268.5724]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - bn: [-468.0768  -484.3329  -486.28036 -502.67386 -532.56757 -518.6412
 -528.0354  -525.1582  -489.78427 -532.94305]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - br: [-1126.1879 -1120.4971 -1119.7444 -1119.4563 -1111.5925 -1121.3168
 -1119.3052 -1119.8706 -1130.8518 -1117.2026]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - bt: [359.4798  352.0624  351.09058 327.97025 303.8453  292.33813 279.48047
 288.82623 303.0881  277.6797 ]...
[CUBBY] - calculate_variables: <bound method mag_rtn_4sa_class.calculate_variables of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>
[CUBBY] - datetime: []...
[CUBBY] - datetime_array: ['2024-12-24T06:00:00.206289408' '2024-12-24T06:00:00.424742656'
 '2024-12-24T06:00:00.643196160' '2024-12-24T06:00:00.861649664'
 '2024-12-24T06:00:01.080102912' '2024-12-24T06:00:01.298556288'
 '2024-12-24T06:00:01.517009792' '2024-12-24T06:00:01.735463040'
 '2024-12-24T06:00:01.953848576' '2024-12-24T06:00:02.172301824']...
[CUBBY] - field: [-1126.1879    359.4798   -468.0768  -1120.4971    352.0624   -484.3329
 -1119.7444    351.09058  -486.28036 -1119.4563 ]...
[CUBBY] - get_subclass: <bound method mag_rtn_4sa_class.get_subclass of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - pmag: [643.2329  642.2061  642.0154  641.9625  641.2305  641.3155  640.5091
 641.9205  640.8281  640.31055]...
[CUBBY] - raw_data: {'all': [array([-1126.1879, -1120.4971, -1119.7444, ..., -1381.3326, -1389.332 ,
       -1392.3956], dtype=float32), array([359.4798 , 352.0624 , 351.09058, ..., 173.14677, 146.52287,
       121.04443], dtype=float32), array([-468.0768 , -484.3329 , -486.28036, ...,  154.47873,  108.6285 ,
         99.726  ], dtype=float32)], 'br': array([-1126.1879, -1120.4971, -1119.7444, ..., -1381.3326, -1389.332 ,
       -1392.3956], dtype=float32), 'bt': array([359.4798 , 352.0624 , 351.09058, ..., 173.14677, 146.52287,
       121.04443], dtype=float32), 'bn': array([-468.0768 , -484.3329 , -486.28036, ...,  154.47873,  108.6285 ,
         99.726  ], dtype=float32), 'bmag': array([1271.464 , 1270.4487, 1270.2601, ..., 1400.6868, 1401.2539,
       1401.2004], dtype=float32), 'pmag': array([643.2329 , 642.2061 , 642.0154 , ..., 780.6245 , 781.2568 ,
       781.19714], dtype=float32)}
[CUBBY] - set_ploptions: <bound method mag_rtn_4sa_class.set_ploptions of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>
[CUBBY] - time: [788292069390289408 788292069608742656 788292069827196160
 788292070045649664 788292070264102912 788292070482556288
 788292070701009792 788292070919463040 788292071137848576
 788292071356301824]...
[CUBBY] - update: <bound method mag_rtn_4sa_class.update of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>
[CUBBY] Stored in class_registry: mag_rtn_4sa
[CUBBY] === End Stashing Debug (LEAVING DATA CUBBY)===

Successfully updated and stored in data_cubby
[35m[ZARR] [get_data] Update completed for mag_rtn_4sa[0m
[35m[ZARR] [get_data] Calling store_data for mag_RTN_4sa[0m
[35m[ZARR] [store_data] Called for data_type=mag_RTN_4sa, trange=['2024-12-24/06:00:00.000', '2024-12-24/07:30:00.000'][0m
[35m[ZARR] Storing data for mag_RTN_4sa[0m
[35m[ZARR] datetime_array length: 24719[0m
[35m[ZARR] raw_data keys: ['all', 'br', 'bt', 'bn', 'bmag', 'pmag'][0m
[35m[ZARR] [store_data] file_time_format=daily[0m
[35m[ZARR] [store_data] Creating data_vars from class_instance.raw_data[0m
[STORE] var_name: br, data shape: (24719,), dims: ['time']
[STORE] var_name: bt, data shape: (24719,), dims: ['time']
[STORE] var_name: bn, data shape: (24719,), dims: ['time']
[STORE] var_name: bmag, data shape: (24719,), dims: ['time']
[STORE] var_name: pmag, data shape: (24719,), dims: ['time']
[STORE] datetime_array: ['2024-12-24T06:00:00.206289408' '2024-12-24T06:00:00.424742656'
 '2024-12-24T06:00:00.643196160' '2024-12-24T06:00:00.861649664'
 '2024-12-24T06:00:01.080102912'] ... total: 24719
[STORE] Dataset variables: ['br', 'bt', 'bn', 'bmag', 'pmag']
[35m[ZARR] [_get_zarr_path] Called for data_type=mag_RTN_4sa, timestamp=2024-12-24T06:00:00.206289408, file_time_format=daily[0m
[35m[ZARR] [_get_zarr_path] Returning path[0m
[35m[ZARR] Checking if Zarr file exists: True[0m
[35m[ZARR] Zarr directory contents: ['time', 'pmag', 'zarr.json', 'bt', 'bn', 'br', 'bmag'][0m
[35m[ZARR] [store_data] Data saved to Zarr store[0m
[35m[ZARR] [get_data] store_data result for mag_RTN_4sa: Success[0m
Call to get_data(...) completed.
✅ Asserted: SPDF mock was called once.
✅ Asserted: Berkeley mock was called once.

✅✅✅ Dynamic mode fallback logic verified successfully within get_data! ✅✅✅
PASSED--- [Fixture] Restored config.data_server to: 'dynamic' ---

tests/test_stardust.py::test_stardust_cleanup_downloaded_files 
=== Testing File Cleanup (stardust) ===
🔵 PHASE 1: Identifying files for cleanup (stardust)
Attempting to clean up 0 file(s) potentially downloaded by stardust tests:
No files were marked for cleanup by stardust tests.
PASSED
tests/test_stardust.py::test_stardust_ham_fetch_and_validate 
--- Testing HAM Fetch/Validate (stardust) --- For trange: ['2025-03-22/12:00:00', '2025-03-22/14:00:00']
🔵 PHASE 1: Calling plotbot to trigger HAM load (hamogram_30s, stardust)
[CUBBY] 
=== Retrieving ham from data_cubby ===
[CUBBY] ✅ Successfully retrieved ham
[CUBBY] 
Plot Options for ham:
[94m[CUBBY] Nham_div_Ncore plot options: data_type='ham', class_name='ham', subclass_name='Nham_div_Ncore', plot_type='scatter', var_name='Nham_div_Ncore', y_label='$N_{{s}}/N_{{core}}$', legend_label='$N_{{ham}}/N_{{core}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] Nham_div_Ncore_og plot options: data_type='ham', class_name='ham', subclass_name='Nham_div_Ncore_og', plot_type='scatter', var_name='Nham_div_Ncore_og', y_label='$N_{{s,og}}/N_{{core,og}}$', legend_label='$N_{{ham}}/N_{{core,og}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] Nham_div_Ntot plot options: data_type='ham', class_name='ham', subclass_name='Nham_div_Ntot', plot_type='scatter', var_name='Nham_div_Ntot', y_label='$N_{{s}}/N_{{tot}}$', legend_label='$N_{{ham}}/N_{{tot}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[94m[CUBBY] Nham_div_Ntot_og plot options: data_type='ham', class_name='ham', subclass_name='Nham_div_Ntot_og', plot_type='scatter', var_name='Nham_div_Ntot_og', y_label='$N_{{s,og}}/N_{{tot,og}}$', legend_label='$N_{{ham,og}}/N_{{tot,og}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[94m[CUBBY] Tperp_ham_div_core plot options: data_type='ham', class_name='ham', subclass_name='Tperp_ham_div_core', plot_type='scatter', var_name='Tperp_ham_div_core', y_label='$T_{{\\perp,h}}/T_{{\\perp,c}}$', legend_label='$T_{{\\perp,h}}/T_{{\\perp,c}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] Tperp_ham_div_core_og plot options: data_type='ham', class_name='ham', subclass_name='Tperp_ham_div_core_og', plot_type='scatter', var_name='Tperp_ham_div_core_og', y_label='$T_{{\\perp,h}}/T_{{\\perp,c}}$', legend_label='$T_{{\\perp,h}}/T_{{\\perp,c}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] Tperprat_driftva_hc plot options: data_type='ham', class_name='ham', subclass_name='Tperprat_driftva_hc', plot_type='scatter', var_name='Tperprat_driftva_hc', y_label='ham param1', legend_label='ham param1', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] Tperprat_driftva_hc_og plot options: data_type='ham', class_name='ham', subclass_name='Tperprat_driftva_hc_og', plot_type='scatter', var_name='Tperprat_driftva_hc_og', y_label='ham param1 og', legend_label='ham param1 og', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] ham_core_drift plot options: data_type='ham', class_name='ham', subclass_name='ham_core_drift', plot_type='scatter', var_name='ham_core_drift', y_label='$v_{{drift}}$ km/s', legend_label='$(vd)_{{h-c}}$ km/s', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[94m[CUBBY] ham_core_drift_va plot options: data_type='ham', class_name='ham', subclass_name='ham_core_drift_va', plot_type='scatter', var_name='ham_core_drift_va', y_label='$v_{{drift}}/v_{{A}}$', legend_label='$(v_{{d}}/v_{{A}})_{{h-c}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[94m[CUBBY] hamogram_20m plot options: data_type='ham', class_name='ham', subclass_name='hamogram_20m', plot_type='time_series', var_name='hamogram_20m', y_label='Hamogram', legend_label='Hamogram_20m', color='palevioletred', y_scale='linear', y_limit=[0, None], line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_2m plot options: data_type='ham', class_name='ham', subclass_name='hamogram_2m', plot_type='time_series', var_name='hamogram_2m', y_label='Hamogram', legend_label='Hamogram_2m', color='palevioletred', y_scale='linear', y_limit=[0, None], line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_30s plot options: data_type='ham', class_name='ham', subclass_name='hamogram_30s', plot_type='time_series', var_name='hamogram_30s', y_label='Hamogram', legend_label='Hamogram_30s', color='palevioletred', y_scale='linear', y_limit=[0, None], line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_4h plot options: data_type='ham', class_name='ham', subclass_name='hamogram_4h', plot_type='time_series', var_name='hamogram_4h', y_label='Hamogram', legend_label='Hamogram_4h', color='palevioletred', y_scale='linear', y_limit=[0, None], line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_90m plot options: data_type='ham', class_name='ham', subclass_name='hamogram_90m', plot_type='time_series', var_name='hamogram_90m', y_label='Hamogram', legend_label='Hamogram_90m', color='palevioletred', y_scale='linear', y_limit=[0, None], line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_og_2m plot options: data_type='ham', class_name='ham', subclass_name='hamogram_og_2m', plot_type='time_series', var_name='hamogram_og_2m', y_label='Hamogram_og_2m', legend_label='Hamogram_og_2m ', color='palevioletred', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_og_30s plot options: data_type='ham', class_name='ham', subclass_name='hamogram_og_30s', plot_type='time_series', var_name='hamogram_og_30s', y_label='Hamogram_og_30s', legend_label='Hamogram_og_30s ', color='palevioletred', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_og_4h plot options: data_type='ham', class_name='ham', subclass_name='hamogram_og_4h', plot_type='time_series', var_name='hamogram_og_4h', y_label='Hamogram_og_4h', legend_label='Hamogram_og_4h', color='palevioletred', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamstring plot options: data_type='ham', class_name='ham', subclass_name='hamstring', plot_type='scatter', var_name='hamstring', y_label='Hamstring (Placeholder)', legend_label='Hamstring (Placeholder)', color='grey', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] trat_ham plot options: data_type='ham', class_name='ham', subclass_name='trat_ham', plot_type='scatter', var_name='trat_ham', y_label='$T_\\perp/T_\\parallel$', legend_label='$(T_\\perp/T_\\parallel)_{{ham}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[94m[CUBBY] trat_ham_og plot options: data_type='ham', class_name='ham', subclass_name='trat_ham_og', plot_type='scatter', var_name='trat_ham_og', y_label='$(T_\\perp/T_\\parallel)_{{og}}$', legend_label='$(T_\\perp/T_\\parallel)_{{ham,og}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: hamogram_30s
Returning plot_manager instance for: hamogram_30s
[35m[ZARR] TRACE: get_data function entry point[0m
[35m[ZARR] INPUT: trange=['2025-03-22/12:00:00', '2025-03-22/14:00:00'], variables=(plot_manager(None, dtype=object),)[0m
Variable type: <class 'plotbot.plot_manager.plot_manager'>, name: None
[35m[ZARR] [get_data] required_data_types: {'ham'}[0m
[35m[ZARR] 
Processing Data Type: ham...[0m
Ham data update required for ['2025-03-22/12:00:00', '2025-03-22/14:00:00'].
Import data function called
Input trange: ['2025-03-22/12:00:00', '2025-03-22/14:00:00']

Importing data for UTC time range: ['2025-03-22/12:00:00', '2025-03-22/14:00:00']

=== Starting Hammerhead CSV Data Import for ['2025-03-22/12:00:00', '2025-03-22/14:00:00'] ===
daterange called with start_date=2025-03-22 12:00:00+00:00, end_date=2025-03-22 14:00:00+00:00
End date has time component, using full day: 2025-03-22
Converted start_date to date: 2025-03-22
Will generate 1 dates
Yielding date: 2025-03-22
Searching for Hammerhead CSV for date: 20250322
 Searching ham in: psp_data/Hamstrings with patterns: ['*_v*.csv']
Searching for CSVs in 'psp_data/Hamstrings' for patterns ['*_v*.csv'] and dates ['20250322', '2025-03-22']
  Found matching file: psp_data/Hamstrings/2025/03/2025-03-22_v00.csv
  Found ham file: '2025-03-22_v00.csv'
Converted HAM 'time' to TT2000 (Length: 48800)
[CUBBY] 
=== Starting ham_class update... ===
[CUBBY] Stored Nham_div_Ncore state: {}
[CUBBY] Stored Nham_div_Ncore_og state: {}
[CUBBY] Stored Nham_div_Ntot state: {}
[CUBBY] Stored Nham_div_Ntot_og state: {}
[CUBBY] Stored Tperp_ham_div_core state: {}
[CUBBY] Stored Tperp_ham_div_core_og state: {}
[CUBBY] Stored Tperprat_driftva_hc state: {}
[CUBBY] Stored Tperprat_driftva_hc_og state: {}
[CUBBY] Stored ham_core_drift state: {}
[CUBBY] Stored ham_core_drift_va state: {}
[CUBBY] Stored hamogram_20m state: {}
[CUBBY] Stored hamogram_2m state: {}
[CUBBY] Stored hamogram_30s state: {}
[CUBBY] Stored hamogram_4h state: {}
[CUBBY] Stored hamogram_90m state: {}
[CUBBY] Stored hamogram_og_2m state: {}
[CUBBY] Stored hamogram_og_30s state: {}
[CUBBY] Stored hamogram_og_4h state: {}
[CUBBY] Stored hamstring state: {}
[CUBBY] Stored trat_ham state: {}
[CUBBY] Stored trat_ham_og state: {}
Successfully converted 4120 TT2000 timestamps to datetime objects.
Assigned data for key: hamogram_30s, shape: (4120,)
Assigned data for key: hamogram_og_30s, shape: (4120,)
Assigned data for key: hamogram_2m, shape: (4120,)
Assigned data for key: hamogram_og_2m, shape: (4120,)
Assigned data for key: hamogram_20m, shape: (4120,)
Assigned data for key: hamogram_90m, shape: (4120,)
Assigned data for key: hamogram_4h, shape: (4120,)
Assigned data for key: hamogram_og_4h, shape: (4120,)
Assigned data for key: trat_ham, shape: (4120,)
Assigned data for key: trat_ham_og, shape: (4120,)
Assigned data for key: ham_core_drift, shape: (4120,)
Assigned data for key: ham_core_drift_va, shape: (4120,)
Assigned data for key: Nham_div_Ncore, shape: (4120,)
Assigned data for key: Nham_div_Ncore_og, shape: (4120,)
Assigned data for key: Nham_div_Ntot, shape: (4120,)
Assigned data for key: Nham_div_Ntot_og, shape: (4120,)
Assigned data for key: Tperp_ham_div_core, shape: (4120,)
Assigned data for key: Tperp_ham_div_core_og, shape: (4120,)
Assigned data for key: Tperprat_driftva_hc, shape: (4120,)
Assigned data for key: Tperprat_driftva_hc_og, shape: (4120,)
[CUBBY] 
=== Stashing Debug (INSIDE DATA CUBBY)===
[CUBBY] Stashing with identifier: ham
[CUBBY] Attributes before stash:

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Nham_div_Ncore: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Nham_div_Ncore_og: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Nham_div_Ntot: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Nham_div_Ntot_og: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tperp_ham_div_core: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tperp_ham_div_core_og: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tperprat_driftva_hc: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tperprat_driftva_hc_og: [None]...
[CUBBY] - _create_ham_scatter_ploptions: <bound method ham_class._create_ham_scatter_ploptions of <plotbot.data_classes.psp_ham_classes.ham_class object at 0x14753d850>>
[CUBBY] - _create_ham_timeseries_ploptions: <bound method ham_class._create_ham_timeseries_ploptions of <plotbot.data_classes.psp_ham_classes.ham_class object at 0x14753d850>>
[CUBBY] - calculate_variables: <bound method ham_class.calculate_variables of <plotbot.data_classes.psp_ham_classes.ham_class object at 0x14753d850>>
[CUBBY] - datetime_array: ['2025-03-22T12:00:00.703000000' '2025-03-22T12:00:02.451000000'
 '2025-03-22T12:00:04.198000000' '2025-03-22T12:00:05.946000000'
 '2025-03-22T12:00:07.694000000' '2025-03-22T12:00:09.441000000'
 '2025-03-22T12:00:11.189000000' '2025-03-22T12:00:12.936000000'
 '2025-03-22T12:00:14.684000000' '2025-03-22T12:00:16.432000000']...
[CUBBY] - get_subclass: <bound method ham_class.get_subclass of <plotbot.data_classes.psp_ham_classes.ham_class object at 0x14753d850>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - ham_core_drift: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - ham_core_drift_va: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - hamogram_20m: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - hamogram_2m: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - hamogram_30s: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - hamogram_4h: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - hamogram_90m: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - hamogram_og_2m: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - hamogram_og_30s: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - hamogram_og_4h: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - hamstring: [None]...
[CUBBY] - raw_data: {'hamstring': None, 'hamstring_og': None, 'hamstring_dt': None, 'N_core': None, 'N_core_og': None, 'N_neck': None, 'N_neck_og': None, 'N_ham': None, 'N_ham_og': None, 'hamogram_30s': array([0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]), 'hamogram_og_30s': array([0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]), 'hamogram_1m': None, 'hamogram_og_1m': None, 'hamogram_2m': array([0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]), 'hamogram_og_2m': array([0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]), 'hamogram_20m': array([0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]), 'hamogram_og_20m': None, 'hamogram_90m': array([0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]), 'hamogram_og_90m': None, 'hamogram_4h': array([5.5, 5.5, 5.5, ..., 5.5, 5.5, 5.5]), 'hamogram_og_4h': array([1.5, 1.5, 1.5, ..., 1.5, 1.5, 1.5]), 'hamogram_12h': None, 'hamogram_og_12h': None, 'trat_ham': array([0.21163203, 0.21163203, 0.21163203, ..., 0.21163203, 0.21163203,
       0.21163203]), 'trat_ham_og': array([0.49967742, 0.49967742, 0.49967742, ..., 0.49967742, 0.49967742,
       0.49967742]), 'ham_core_drift': array([79.84109909, 79.84109909, 79.84109909, ..., 79.84109909,
       79.84109909, 79.84109909]), 'ham_core_drift_va': array([0.54119224, 0.54119224, 0.54119224, ..., 0.54119224, 0.54119224,
       0.54119224]), 'Nham_div_Ncore': array([1.77144603e-05, 1.77144603e-05, 1.77144603e-05, ...,
       1.77144603e-05, 1.77144603e-05, 1.77144603e-05]), 'Nham_div_Ncore_og': array([1.77144603e-05, 1.77144603e-05, 1.77144603e-05, ...,
       1.77144603e-05, 1.77144603e-05, 1.77144603e-05]), 'Nham_div_Ntot': array([1.77133613e-05, 1.77133613e-05, 1.77133613e-05, ...,
       1.77133613e-05, 1.77133613e-05, 1.77133613e-05]), 'Nham_div_Ntot_og': array([1.77133613e-05, 1.77133613e-05, 1.77133613e-05, ...,
       1.77133613e-05, 1.77133613e-05, 1.77133613e-05]), 'Tperp_ham_div_core': array([0.31831987, 0.31831987, 0.31831987, ..., 0.31831987, 0.31831987,
       0.31831987]), 'Tperp_ham_div_core_og': array([0.88389542, 0.88389542, 0.88389542, ..., 0.88389542, 0.88389542,
       0.88389542]), 'Tperprat_driftva_hc': array([0.53825738, 0.53825738, 0.53825738, ..., 0.53825738, 0.53825738,
       0.53825738]), 'Tperprat_driftva_hc_og': array([1.301058, 1.301058, 1.301058, ..., 1.301058, 1.301058, 1.301058])}
[CUBBY] - set_ploptions: <bound method ham_class.set_ploptions of <plotbot.data_classes.psp_ham_classes.ham_class object at 0x14753d850>>
[CUBBY] - time: [795916869887000000 795916871635000000 795916873382000000
 795916875130000000 795916876878000000 795916878625000000
 795916880373000000 795916882120000000 795916883868000000
 795916885616000000]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - trat_ham: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - trat_ham_og: [None]...
[CUBBY] - update: <bound method ham_class.update of <plotbot.data_classes.psp_ham_classes.ham_class object at 0x14753d850>>
[CUBBY] Stored in class_registry: ham
[CUBBY] === End Stashing Debug (LEAVING DATA CUBBY)===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamstring[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_30s[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_og_30s[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_2m[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_og_2m[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_20m[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_90m[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_4h[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=hamogram_og_4h[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=trat_ham[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=trat_ham_og[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=ham_core_drift[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=ham_core_drift_va[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Nham_div_Ncore[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Nham_div_Ncore_og[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Nham_div_Ntot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Nham_div_Ntot_og[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Tperp_ham_div_core[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Tperp_ham_div_core_og[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Tperprat_driftva_hc[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=ham, class=ham, subclass=Tperprat_driftva_hc_og[0m
[CUBBY] Restoring saved state...
[CUBBY] Restored Nham_div_Ncore state: {}
[CUBBY] Restored Nham_div_Ncore_og state: {}
[CUBBY] Restored Nham_div_Ntot state: {}
[CUBBY] Restored Nham_div_Ntot_og state: {}
[CUBBY] Restored Tperp_ham_div_core state: {}
[CUBBY] Restored Tperp_ham_div_core_og state: {}
[CUBBY] Restored Tperprat_driftva_hc state: {}
[CUBBY] Restored Tperprat_driftva_hc_og state: {}
[CUBBY] Restored ham_core_drift state: {}
[CUBBY] Restored ham_core_drift_va state: {}
[CUBBY] Restored hamogram_20m state: {}
[CUBBY] Restored hamogram_2m state: {}
[CUBBY] Restored hamogram_30s state: {}
[CUBBY] Restored hamogram_4h state: {}
[CUBBY] Restored hamogram_90m state: {}
[CUBBY] Restored hamogram_og_2m state: {}
[CUBBY] Restored hamogram_og_30s state: {}
[CUBBY] Restored hamogram_og_4h state: {}
[CUBBY] Restored hamstring state: {}
[CUBBY] Restored trat_ham state: {}
[CUBBY] Restored trat_ham_og state: {}
[CUBBY] === Finished ham_class update ===

[CUBBY] 
=== Retrieving ham from data_cubby ===
[CUBBY] ✅ Successfully retrieved ham
[CUBBY] 
Plot Options for ham:
[94m[CUBBY] Nham_div_Ncore plot options: data_type='ham', class_name='ham', subclass_name='Nham_div_Ncore', plot_type='scatter', var_name='Nham_div_Ncore', y_label='$N_{{s}}/N_{{core}}$', legend_label='$N_{{ham}}/N_{{core}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] Nham_div_Ncore_og plot options: data_type='ham', class_name='ham', subclass_name='Nham_div_Ncore_og', plot_type='scatter', var_name='Nham_div_Ncore_og', y_label='$N_{{s,og}}/N_{{core,og}}$', legend_label='$N_{{ham}}/N_{{core,og}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] Nham_div_Ntot plot options: data_type='ham', class_name='ham', subclass_name='Nham_div_Ntot', plot_type='scatter', var_name='Nham_div_Ntot', y_label='$N_{{s}}/N_{{tot}}$', legend_label='$N_{{ham}}/N_{{tot}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[94m[CUBBY] Nham_div_Ntot_og plot options: data_type='ham', class_name='ham', subclass_name='Nham_div_Ntot_og', plot_type='scatter', var_name='Nham_div_Ntot_og', y_label='$N_{{s,og}}/N_{{tot,og}}$', legend_label='$N_{{ham,og}}/N_{{tot,og}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[94m[CUBBY] Tperp_ham_div_core plot options: data_type='ham', class_name='ham', subclass_name='Tperp_ham_div_core', plot_type='scatter', var_name='Tperp_ham_div_core', y_label='$T_{{\\perp,h}}/T_{{\\perp,c}}$', legend_label='$T_{{\\perp,h}}/T_{{\\perp,c}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] Tperp_ham_div_core_og plot options: data_type='ham', class_name='ham', subclass_name='Tperp_ham_div_core_og', plot_type='scatter', var_name='Tperp_ham_div_core_og', y_label='$T_{{\\perp,h}}/T_{{\\perp,c}}$', legend_label='$T_{{\\perp,h}}/T_{{\\perp,c}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] Tperprat_driftva_hc plot options: data_type='ham', class_name='ham', subclass_name='Tperprat_driftva_hc', plot_type='scatter', var_name='Tperprat_driftva_hc', y_label='ham param1', legend_label='ham param1', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] Tperprat_driftva_hc_og plot options: data_type='ham', class_name='ham', subclass_name='Tperprat_driftva_hc_og', plot_type='scatter', var_name='Tperprat_driftva_hc_og', y_label='ham param1 og', legend_label='ham param1 og', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] ham_core_drift plot options: data_type='ham', class_name='ham', subclass_name='ham_core_drift', plot_type='scatter', var_name='ham_core_drift', y_label='$v_{{drift}}$ km/s', legend_label='$(vd)_{{h-c}}$ km/s', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[94m[CUBBY] ham_core_drift_va plot options: data_type='ham', class_name='ham', subclass_name='ham_core_drift_va', plot_type='scatter', var_name='ham_core_drift_va', y_label='$v_{{drift}}/v_{{A}}$', legend_label='$(v_{{d}}/v_{{A}})_{{h-c}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[94m[CUBBY] hamogram_20m plot options: data_type='ham', class_name='ham', subclass_name='hamogram_20m', plot_type='time_series', var_name='hamogram_20m', y_label='Hamogram', legend_label='Hamogram_20m', color='palevioletred', y_scale='linear', y_limit=[0, None], line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_2m plot options: data_type='ham', class_name='ham', subclass_name='hamogram_2m', plot_type='time_series', var_name='hamogram_2m', y_label='Hamogram', legend_label='Hamogram_2m', color='palevioletred', y_scale='linear', y_limit=[0, None], line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_30s plot options: data_type='ham', class_name='ham', subclass_name='hamogram_30s', plot_type='time_series', var_name='hamogram_30s', y_label='Hamogram', legend_label='Hamogram_30s', color='palevioletred', y_scale='linear', y_limit=[0, None], line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_4h plot options: data_type='ham', class_name='ham', subclass_name='hamogram_4h', plot_type='time_series', var_name='hamogram_4h', y_label='Hamogram', legend_label='Hamogram_4h', color='palevioletred', y_scale='linear', y_limit=[0, None], line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_90m plot options: data_type='ham', class_name='ham', subclass_name='hamogram_90m', plot_type='time_series', var_name='hamogram_90m', y_label='Hamogram', legend_label='Hamogram_90m', color='palevioletred', y_scale='linear', y_limit=[0, None], line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_og_2m plot options: data_type='ham', class_name='ham', subclass_name='hamogram_og_2m', plot_type='time_series', var_name='hamogram_og_2m', y_label='Hamogram_og_2m', legend_label='Hamogram_og_2m ', color='palevioletred', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_og_30s plot options: data_type='ham', class_name='ham', subclass_name='hamogram_og_30s', plot_type='time_series', var_name='hamogram_og_30s', y_label='Hamogram_og_30s', legend_label='Hamogram_og_30s ', color='palevioletred', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamogram_og_4h plot options: data_type='ham', class_name='ham', subclass_name='hamogram_og_4h', plot_type='time_series', var_name='hamogram_og_4h', y_label='Hamogram_og_4h', legend_label='Hamogram_og_4h', color='palevioletred', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] hamstring plot options: data_type='ham', class_name='ham', subclass_name='hamstring', plot_type='scatter', var_name='hamstring', y_label='Hamstring (Placeholder)', legend_label='Hamstring (Placeholder)', color='grey', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=20, alpha=0.2[0m
[94m[CUBBY] trat_ham plot options: data_type='ham', class_name='ham', subclass_name='trat_ham', plot_type='scatter', var_name='trat_ham', y_label='$T_\\perp/T_\\parallel$', legend_label='$(T_\\perp/T_\\parallel)_{{ham}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[94m[CUBBY] trat_ham_og plot options: data_type='ham', class_name='ham', subclass_name='trat_ham_og', plot_type='scatter', var_name='trat_ham_og', y_label='$(T_\\perp/T_\\parallel)_{{og}}$', legend_label='$(T_\\perp/T_\\parallel)_{{ham,og}}$', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style=(5, 1), marker_size=50, alpha=0.9[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: hamogram_30s
Returning plot_manager instance for: hamogram_30s

DEBUG:
var: [0.5 0.5 0.5 ... 0.5 0.5 0.5]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2025-03-22T12:00:00.703000000
Time range: 2025-03-22T12:00:00.703000000 to 2025-03-22T13:59:59.207000000
var.data type: <class 'numpy.ndarray'>
var.data shape: (4120,)

Variable verification for ham.hamogram_30s:
Plot attributes example:
- Color: palevioletred
- Y-label: Hamogram
- Legend: Hamogram_30s
Setting title from plt.options: Multiplot Stardust Test
Plotbot call completed (stardust - HAM).
🔵 PHASE 2: Verifying HAM Data Availability Post-Plotbot Call (stardust)
ham_instance datetime_array loaded (stardust). Length: 4120.
✅ HAM data validated for 'hamogram_30s' (stardust).
--- Explicitly closed HAM figure 1 in finally block ---
PASSED
tests/test_stardust.py::test_stardust_fits_group_1 --- Loading SF00 Test Data Fixture (stardust) ---
Searching for SF00 files for date: 20240930 in /Users/robertalexander/GitHub/Plotbot/psp_data
Searching for CSVs in '/Users/robertalexander/GitHub/Plotbot/psp_data' for patterns ['*sf00*.csv'] and dates ['20240930', '2024-09-30']
  Found matching file: /Users/robertalexander/GitHub/Plotbot/psp_data/sweap/spi_fits/sf00/p2/v00/2024/09/spp_swp_spi_sf00_2024-09-30_v00.csv
Loaded SF00 test data (stardust), shape: (37065, 28)
Updating proton_fits_instance with test data (stardust)...
[CUBBY] 
=== Update Debug ===
[CUBBY] Starting proton_fits_class update...
FITS Calculation: Determined dependency trange: ['2024-09-30/00:00:01.536000', '2024-09-30/23:59:54.893000']
FITS Calculation: Importing proton moment data directly...
Import data function called
Input trange: ['2024-09-30/00:00:01.536000', '2024-09-30/23:59:54.893000']

Importing data for UTC time range: ['2024-09-30/00:00:01.536000', '2024-09-30/23:59:54.893000']

=== Starting import for spi_sf00_l3_mom (CDF) ===
daterange called with start_date=2024-09-30 00:00:01.536000+00:00, end_date=2024-09-30 23:59:54.893000+00:00
End date has time component, using full day: 2024-09-30
Converted start_date to date: 2024-09-30
Will generate 1 dates
Yielding date: 2024-09-30
Found 1 unique CDF files to process.

Processing CDF file: psp_data/sweap/spi/l3/spi_sf00_l3_mom/2024/psp_swp_spi_sf00_L3_mom_20240930_v04.cdf
Successfully opened CDF file
Using time variable: Epoch
File time range (TT2000): 780926470720279936 to 781012867573061888
Reading full time data array...
Read 37066 time points
Time indices: 0 to 37064
Extracted 37064 time points within requested range

Reading variable: VEL_RTN_SUN
Raw data shape: (37064, 3)
Successfully stored data slice for VEL_RTN_SUN

Reading variable: DENS
Raw data shape: (37064,)
Successfully stored data slice for DENS

Reading variable: TEMP
Raw data shape: (37064,)
Successfully stored data slice for TEMP

Reading variable: MAGF_INST
Raw data shape: (37064, 3)
Successfully stored data slice for MAGF_INST

Reading variable: T_TENSOR_INST
Raw data shape: (37064, 6)
Successfully stored data slice for T_TENSOR_INST

Reading variable: EFLUX_VS_ENERGY
Raw data shape: (37064, 32)
Successfully stored data slice for EFLUX_VS_ENERGY

Reading variable: EFLUX_VS_THETA
Raw data shape: (37064, 8)
Successfully stored data slice for EFLUX_VS_THETA

Reading variable: EFLUX_VS_PHI
Raw data shape: (37064, 8)
Successfully stored data slice for EFLUX_VS_PHI

Reading variable: ENERGY_VALS
Raw data shape: (37064, 32)
Successfully stored data slice for ENERGY_VALS

Reading variable: THETA_VALS
Raw data shape: (37064, 8)
Successfully stored data slice for THETA_VALS

Reading variable: PHI_VALS
Raw data shape: (37064, 8)
Successfully stored data slice for PHI_VALS

Concatenating CDF data...
  Concatenated VEL_RTN_SUN (Shape: (37064, 3))
  Concatenated DENS (Shape: (37064,))
  Concatenated TEMP (Shape: (37064,))
  Concatenated MAGF_INST (Shape: (37064, 3))
  Concatenated T_TENSOR_INST (Shape: (37064, 6))
  Concatenated EFLUX_VS_ENERGY (Shape: (37064, 32))
  Concatenated EFLUX_VS_THETA (Shape: (37064, 8))
  Concatenated EFLUX_VS_PHI (Shape: (37064, 8))
  Concatenated ENERGY_VALS (Shape: (37064, 32))
  Concatenated THETA_VALS (Shape: (37064, 8))
  Concatenated PHI_VALS (Shape: (37064, 8))

Total CDF data points after concatenation: 37064
 Checking proton data availability post import_data_function call:
  proton_times length: 37064
  proton time range: 2024-09-30T00:00:01.536279936 to 2024-09-30T23:59:51.398520064
  Calculated vsw_mom_data length: 37064
  vsw_mom_data valid points: 37064
FITS Calculation: Proton data found. Aligning v_sw...
Alignment successful. Shape: (37065,)
[CUBBY] 
=== Stashing Debug (INSIDE DATA CUBBY)===
[CUBBY] Stashing with identifier: proton_fits
[CUBBY] Attributes before stash:

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Temp_tot: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tpar1: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tpar2: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tpar_tot: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tperp1: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tperp2: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tperp_tot: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Trat1: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Trat2: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Trat_tot: [None]...
[CUBBY] - _create_fits_scatter_ploptions: <bound method proton_fits_class._create_fits_scatter_ploptions of <plotbot.data_classes.psp_proton_fits_classes.proton_fits_class object at 0x14753c650>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - abs_qz_p: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - beta_ppar_pfits: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - beta_pperp_pfits: [None]...
[CUBBY] - calculate_variables: <bound method proton_fits_class.calculate_variables of <plotbot.data_classes.psp_proton_fits_classes.proton_fits_class object at 0x14753c650>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - chi_p: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - chi_p_norm: [None]...
[CUBBY] - datetime: []...
[CUBBY] - datetime_array: ['2024-09-30T00:00:01.536000000' '2024-09-30T00:00:03.283000000'
 '2024-09-30T00:00:05.031000000' '2024-09-30T00:00:06.779000000'
 '2024-09-30T00:00:08.526000000' '2024-09-30T00:00:10.274000000'
 '2024-09-30T00:00:12.022000000' '2024-09-30T00:00:13.769000000'
 '2024-09-30T00:00:15.517000000' '2024-09-30T00:00:17.264000000']...
[CUBBY] - get_subclass: <bound method proton_fits_class.get_subclass of <plotbot.data_classes.psp_proton_fits_classes.proton_fits_class object at 0x14753c650>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - ham_param: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - n_tot: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - np1: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - np2: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - np2_np1_ratio: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - qz_p: [None]...
[CUBBY] - raw_data: {'np1': array([4331.93959003, 7594.16165139, 7412.49130821, ...,  476.58785091,
        550.35829121,  701.7589304 ]), 'np2': array([3519.65996536,  269.46579429,  293.69131106, ..., 1465.42689611,
       1417.69534123, 1164.97649813]), 'Tperp1': array([29.34656297, 33.53293609, 32.03025502, ..., 27.02898398,
       26.65600493, 51.64370739]), 'Tperp2': array([34.80327909, 40.33398175, 44.73075948, ..., 53.29636816,
       44.22945079, 36.12813124]), 'Trat1': array([1.49098345, 1.01901078, 0.98992526, ..., 2.58274346, 4.0251279 ,
       6.07445803]), 'Trat2': array([0.95483668, 0.30780737, 0.32783647, ..., 1.88865938, 1.88395344,
       1.90464838]), 'vdrift': array([ 54.89107756, 131.67405172, 136.28329283, ...,   8.60117924,
        17.34333725,  37.47261134]), 'B_inst_x': array([-1016.57 , -1014.86 , -1030.79 , ...,  -603.506,  -634.78 ,
        -639.815]), 'B_inst_y': array([ 165.582 ,   85.0561,   15.1704, ..., -206.956 , -143.047 ,
       -104.035 ]), 'B_inst_z': array([  17.6946,  111.262 ,   29.3583, ..., -111.199 ,  -25.4051,
        -29.879 ]), 'vp1_x': array([-166.23724772, -187.36287522, -187.00118281, ..., -204.12380316,
       -183.60104044, -167.54797628]), 'vp1_y': array([135.65288612, 145.61436943, 155.64844731, ..., 157.78979287,
       131.40460181, 115.90263404]), 'vp1_z': array([ 55.15988672,  42.49875274,  56.67156082, ..., 178.56867505,
       135.16918891, 124.17588795]), 'chi': array([1090.08075774, 1194.80102582, 1060.77901829, ...,  566.43351883,
        551.99678326,  470.09627361]), 'qz_p': array([ 5.50428623e-04,  1.30805058e-03,  1.59361358e-03, ...,
        2.61155675e-05,  4.64431665e-05, -4.29669930e-06]), 'vsw_mach': array([       nan, 0.63251834, 0.61707829, ..., 0.98507619, 0.88840602,
              nan]), 'beta_ppar': array([0.10429912, 0.12759895, 0.12680989, ..., 0.04479384, 0.03627746,
       0.03300291]), 'beta_pperp': array([0.09480152, 0.10195357, 0.09493624, ..., 0.08742261, 0.07353274,
       0.07496672]), 'ham_param': array([1.30475289, 1.50537321, 1.86537857, ..., 1.01032798, 0.81860154,
       0.30797241]), 'n_tot': array([7851.59955539, 7863.62744569, 7706.18261927, ..., 1942.01474702,
       1968.05363243, 1866.73542853]), 'np2_np1_ratio': array([0.81249055, 0.03548328, 0.03962113, ..., 3.07483058, 2.57594982,
       1.66008076]), 'vp1_mag': array([221.53812572, 241.06956585, 249.81502622, ..., 313.7688918 ,
       263.14866722, 238.59043586]), 'vcm_x': array([-190.51979446, -191.83263859, -192.19242575, ..., -210.17204279,
       -195.77947747, -190.60593406]), 'vcm_y': array([139.60810087, 145.98898331, 155.72484816, ..., 155.71571327,
       128.66020393, 112.15337115]), 'vcm_z': array([ 55.58255309,  42.98878567,  56.81941447, ..., 177.45425664,
       134.68178475, 123.09909432]), 'vcm_mag': array([242.64713911, 244.86849566, 253.80426062, ..., 316.08493183,
       270.22626634, 253.10548746]), 'vdrift_abs': array([ 54.89107756, 131.67405172, 136.28329283, ...,   8.60117924,
        17.34333725,  37.47261134]), 'vdrift_va': array([0.21658928, 0.52282056, 0.53212359, ..., 0.0268476 , 0.05419813,
       0.1144503 ]), 'Trat_tot': array([0.90893882, 0.79901574, 0.74865011, ..., 1.95166607, 2.02695418,
       2.27151849]), 'Tpar1': array([19.68268856, 32.90734178, 32.35623581, ..., 10.46522211,
        6.62239949,  8.50178026]), 'Tpar2': array([ 36.44945758, 131.03643854, 136.4422925 , ...,  28.21915306,
        23.47693413,  18.96839942]), 'Tpar_tot': array([34.97777915, 42.25948048, 43.43054939, ..., 24.00519074,
       19.39614998, 18.47261106]), 'Tperp_tot': array([31.79266139, 33.76599   , 32.51428557, ..., 46.8501163 ,
       39.31510726, 41.96087752]), 'Temp_tot': array([32.85436731, 36.5971535 , 36.15304018, ..., 39.23514111,
       32.67545483, 34.13145536]), '|qz_p|': None, 'chi_p_norm': array([0.5348777 , 0.58626154, 0.52050001, ..., 0.27793598, 0.2708522 ,
       0.23066549]), 'valfven': array([253.43395527, 251.85324178, 256.11210647, ..., 320.37046215,
       319.99880826, 327.41384449]), 'B_mag': array([1030.11895551, 1024.47771688, 1031.31957943, ...,  647.62295788,
        651.19391253,  648.90621055]), 'bhat_x': array([-0.98684719, -0.99061208, -0.9994865 , ..., -0.93187864,
       -0.97479412, -0.98598995]), 'bhat_y': array([ 0.16074066,  0.08302387,  0.0147097 , ..., -0.31956248,
       -0.21966882, -0.16032363]), 'bhat_z': array([ 0.01717724,  0.10860363,  0.02846673, ..., -0.1717033 ,
       -0.03901311, -0.04604517]), 'vp2_x': array([-220.40635355, -317.80078121, -323.21449459, ..., -212.13905836,
       -200.50722369, -204.49559434]), 'vp2_y': array([144.47611412, 156.54645817, 157.65313345, ..., 155.04117868,
       127.59481133, 109.89488892]), 'vp2_z': array([ 56.10276391,  56.79903288,  60.55110105, ..., 177.09182418,
       134.49257138, 122.45045501]), 'vp2_mag': array([269.44355319, 358.78999462, 364.67596005, ..., 316.86315873,
       273.07843999, 262.46799547]), 'qz_p_perp': array([ 1.41264910e-11,  3.06241563e-11,  4.02915669e-11, ...,
        1.51482579e-12,  3.45801960e-12, -3.05891285e-13]), 'qz_p_par': array([ 1.22415462e-11,  2.18724349e-11,  2.60995185e-11, ...,
        4.13019882e-12,  9.97914534e-12, -1.04722865e-12]), 'Vcm_mach': array([0.95743737, 0.9722666 , 0.99098892, ..., 0.9866232 , 0.84446023,
       0.77304455]), 'Vp1_mach': array([0.8741454 , 0.9571827 , 0.9754128 , ..., 0.97939395, 0.82234265,
       0.72871212]), 'beta_p_tot': array([0.14094551, 0.16332796, 0.15840972, ..., 0.09823034, 0.08199462,
       0.08190971]), 'chi_p': array([1090.08075774, 1194.80102582, 1060.77901829, ...,  566.43351883,
        551.99678326,  470.09627361]), 'abs_qz_p': array([5.50428623e-04, 1.30805058e-03, 1.59361358e-03, ...,
       2.61155675e-05, 4.64431665e-05, 4.29669930e-06])}
[CUBBY] - set_ploptions: <bound method proton_fits_class.set_ploptions of <plotbot.data_classes.psp_proton_fits_classes.proton_fits_class object at 0x14753c650>>
[CUBBY] - time: [780926470720000000 780926472467000000 780926474215000000
 780926475963000000 780926477710000000 780926479458000000
 780926481206000000 780926482953000000 780926484701000000
 780926486448000000]...
[CUBBY] - update: <bound method proton_fits_class.update of <plotbot.data_classes.psp_proton_fits_classes.proton_fits_class object at 0x14753c650>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - valfven_pfits: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vcm_mag: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vcm_x: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vcm_y: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vcm_z: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vdrift: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vdrift_abs: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vdrift_va_pfits: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vp1_mag: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vp1_x: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vp1_y: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vp1_z: [None]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vsw_mach_pfits: [None]...
[CUBBY] Stored in class_registry: proton_fits
[CUBBY] === End Stashing Debug (LEAVING DATA CUBBY)===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=qz_p[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vsw_mach_pfits[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=beta_ppar_pfits[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=beta_pperp_pfits[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=ham_param[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=np1[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=np2[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=n_tot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=np2_np1_ratio[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_x[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_y[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_z[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_mag[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_x[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_y[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_z[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_mag[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vdrift[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vdrift_abs[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vdrift_va_pfits[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Trat1[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Trat2[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Trat_tot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tpar1[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tpar2[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tpar_tot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tperp1[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tperp2[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tperp_tot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Temp_tot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=abs_qz_p[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=chi_p[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=chi_p_norm[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=valfven_pfits[0m
[CUBBY] Restoring saved state...
[CUBBY] === End Update Debug ===

proton_fits_instance update complete (stardust).
\n--- Testing FITS Group (stardust): ['qz_p', 'vsw_mach_pfits', 'beta_ppar_pfits', 'beta_pperp_pfits', 'ham_param'] --- For trange: ['2024-09-30/11:45:00.000', '2024-09-30/12:45:00.000']
Attempting plotbot call (stardust FITS) for trange: ['2024-09-30/11:45:00.000', '2024-09-30/12:45:00.000'] with variables: ['qz_p', 'vsw_mach_pfits', 'beta_ppar_pfits', 'beta_pperp_pfits', 'ham_param']

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] 
=== Retrieving proton_fits from data_cubby ===
[CUBBY] ✅ Successfully retrieved proton_fits
[CUBBY] 
Plot Options for proton_fits:
[94m[CUBBY] Temp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Temp_tot', plot_type='scatter', var_name='Temp_tot', y_label='$Temp_{tot}$', legend_label='$T_{tot}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar1', plot_type='scatter', var_name='Tpar1', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar2', plot_type='scatter', var_name='Tpar2', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar_tot', plot_type='scatter', var_name='Tpar_tot', y_label='$T_\\parallel$', legend_label='$T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp1', plot_type='scatter', var_name='Tperp1', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp2', plot_type='scatter', var_name='Tperp2', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp_tot', plot_type='scatter', var_name='Tperp_tot', y_label='$T_{\\perp}$', legend_label='$T_{\\perp}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat1', plot_type='scatter', var_name='Trat1', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat2', plot_type='scatter', var_name='Trat2', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat_tot', plot_type='scatter', var_name='Trat_tot', y_label='$T_\\perp/T_\\parallel$', legend_label='$T_\\perp/T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] abs_qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='abs_qz_p', plot_type='scatter', var_name='abs_qz_p', y_label='$|Q_p| W/m^2$', legend_label='$|Q_p|$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] beta_ppar_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_ppar_pfits', plot_type='scatter', var_name='beta_ppar', y_label='$\\beta_{\\parallel,p}$', legend_label='$\\beta_{\\parallel,p}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] beta_pperp_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_pperp_pfits', plot_type='scatter', var_name='beta_pperp', y_label='$\\beta_{\\perp,p}$', legend_label='$\\beta_{\\perp,p}$', color='lightskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] chi_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p', plot_type='scatter', var_name='chi_p', y_label='$\\chi_p$', legend_label='$\\chi_p$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] chi_p_norm plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p_norm', plot_type='scatter', var_name='chi_p_norm', y_label='$\\chi_p norm$', legend_label='$\\chi_p norm$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] ham_param plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='ham_param', plot_type='scatter', var_name='ham_param', y_label='Hamplitude', legend_label='Hamplitude', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] n_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='n_tot', plot_type='scatter', var_name='n_tot', y_label='Density (cm$^{-3}$)', legend_label='$n_{ptot}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np1', plot_type='scatter', var_name='np1', y_label='Density (cm$^{-3}$)', legend_label='$n_{p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2', plot_type='scatter', var_name='np2', y_label='Density (cm$^{-3}$)', legend_label='$n_{p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2_np1_ratio plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2_np1_ratio', plot_type='scatter', var_name='np2_np1_ratio', y_label='$\\frac{n_{p2}}{n_{p1}}$', legend_label='$\\frac{n_{p2}}{n_{p1}}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='qz_p', plot_type='scatter', var_name='qz_p', y_label='$q_{z,p}$ (W/m$^2$)', legend_label='$q_{z,p}$', color='blueviolet', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] valfven_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='valfven_pfits', plot_type='time_series', var_name='valfven', y_label='V$_{A}$ (km/s)', legend_label='V$_{A}$', color=None, y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] vcm_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_mag', plot_type='scatter', var_name='vcm_mag', y_label='Velocity (km/s)', legend_label='$vmag_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_x', plot_type='scatter', var_name='vcm_x', y_label='Velocity (km/s)', legend_label='$vx_{cm}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_y', plot_type='scatter', var_name='vcm_y', y_label='Velocity (km/s)', legend_label='$vy_{cm}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_z', plot_type='scatter', var_name='vcm_z', y_label='Velocity (km/s)', legend_label='$vz_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift', plot_type='scatter', var_name='vdrift', y_label='$V_{drift}$', legend_label='$vdrift_{p2}$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_abs plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_abs', plot_type='scatter', var_name='vdrift_abs', y_label='$|V_{drift}|$', legend_label='$|vdrift_{p2}|$ ', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_va_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_va_pfits', plot_type='scatter', var_name='vdrift_va', y_label='$V_{drift}/V_A$', legend_label='$vdrift_{p2}/vA$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_mag', plot_type='scatter', var_name='vp1_mag', y_label='Velocity (km/s)', legend_label='$vmag_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_x', plot_type='scatter', var_name='vp1_x', y_label='Velocity (km/s)', legend_label='$vx_{p1}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_y', plot_type='scatter', var_name='vp1_y', y_label='Velocity (km/s)', legend_label='$vy_{p1}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_z', plot_type='scatter', var_name='vp1_z', y_label='Velocity (km/s)', legend_label='$vz_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vsw_mach_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vsw_mach_pfits', plot_type='scatter', var_name='vsw_mach', y_label='$V_{sw}/V_A$', legend_label='$V_{sw}/V_A$', color='gold', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: qz_p
Returning plot_manager instance for: qz_p
[CUBBY] 
=== Retrieving proton_fits from data_cubby ===
[CUBBY] ✅ Successfully retrieved proton_fits
[CUBBY] 
Plot Options for proton_fits:
[94m[CUBBY] Temp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Temp_tot', plot_type='scatter', var_name='Temp_tot', y_label='$Temp_{tot}$', legend_label='$T_{tot}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar1', plot_type='scatter', var_name='Tpar1', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar2', plot_type='scatter', var_name='Tpar2', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar_tot', plot_type='scatter', var_name='Tpar_tot', y_label='$T_\\parallel$', legend_label='$T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp1', plot_type='scatter', var_name='Tperp1', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp2', plot_type='scatter', var_name='Tperp2', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp_tot', plot_type='scatter', var_name='Tperp_tot', y_label='$T_{\\perp}$', legend_label='$T_{\\perp}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat1', plot_type='scatter', var_name='Trat1', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat2', plot_type='scatter', var_name='Trat2', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat_tot', plot_type='scatter', var_name='Trat_tot', y_label='$T_\\perp/T_\\parallel$', legend_label='$T_\\perp/T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] abs_qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='abs_qz_p', plot_type='scatter', var_name='abs_qz_p', y_label='$|Q_p| W/m^2$', legend_label='$|Q_p|$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] beta_ppar_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_ppar_pfits', plot_type='scatter', var_name='beta_ppar', y_label='$\\beta_{\\parallel,p}$', legend_label='$\\beta_{\\parallel,p}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] beta_pperp_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_pperp_pfits', plot_type='scatter', var_name='beta_pperp', y_label='$\\beta_{\\perp,p}$', legend_label='$\\beta_{\\perp,p}$', color='lightskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] chi_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p', plot_type='scatter', var_name='chi_p', y_label='$\\chi_p$', legend_label='$\\chi_p$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] chi_p_norm plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p_norm', plot_type='scatter', var_name='chi_p_norm', y_label='$\\chi_p norm$', legend_label='$\\chi_p norm$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] ham_param plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='ham_param', plot_type='scatter', var_name='ham_param', y_label='Hamplitude', legend_label='Hamplitude', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] n_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='n_tot', plot_type='scatter', var_name='n_tot', y_label='Density (cm$^{-3}$)', legend_label='$n_{ptot}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np1', plot_type='scatter', var_name='np1', y_label='Density (cm$^{-3}$)', legend_label='$n_{p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2', plot_type='scatter', var_name='np2', y_label='Density (cm$^{-3}$)', legend_label='$n_{p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2_np1_ratio plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2_np1_ratio', plot_type='scatter', var_name='np2_np1_ratio', y_label='$\\frac{n_{p2}}{n_{p1}}$', legend_label='$\\frac{n_{p2}}{n_{p1}}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='qz_p', plot_type='scatter', var_name='qz_p', y_label='$q_{z,p}$ (W/m$^2$)', legend_label='$q_{z,p}$', color='blueviolet', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] valfven_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='valfven_pfits', plot_type='time_series', var_name='valfven', y_label='V$_{A}$ (km/s)', legend_label='V$_{A}$', color=None, y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] vcm_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_mag', plot_type='scatter', var_name='vcm_mag', y_label='Velocity (km/s)', legend_label='$vmag_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_x', plot_type='scatter', var_name='vcm_x', y_label='Velocity (km/s)', legend_label='$vx_{cm}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_y', plot_type='scatter', var_name='vcm_y', y_label='Velocity (km/s)', legend_label='$vy_{cm}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_z', plot_type='scatter', var_name='vcm_z', y_label='Velocity (km/s)', legend_label='$vz_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift', plot_type='scatter', var_name='vdrift', y_label='$V_{drift}$', legend_label='$vdrift_{p2}$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_abs plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_abs', plot_type='scatter', var_name='vdrift_abs', y_label='$|V_{drift}|$', legend_label='$|vdrift_{p2}|$ ', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_va_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_va_pfits', plot_type='scatter', var_name='vdrift_va', y_label='$V_{drift}/V_A$', legend_label='$vdrift_{p2}/vA$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_mag', plot_type='scatter', var_name='vp1_mag', y_label='Velocity (km/s)', legend_label='$vmag_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_x', plot_type='scatter', var_name='vp1_x', y_label='Velocity (km/s)', legend_label='$vx_{p1}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_y', plot_type='scatter', var_name='vp1_y', y_label='Velocity (km/s)', legend_label='$vy_{p1}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_z', plot_type='scatter', var_name='vp1_z', y_label='Velocity (km/s)', legend_label='$vz_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vsw_mach_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vsw_mach_pfits', plot_type='scatter', var_name='vsw_mach', y_label='$V_{sw}/V_A$', legend_label='$V_{sw}/V_A$', color='gold', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: vsw_mach_pfits
Returning plot_manager instance for: vsw_mach_pfits
[CUBBY] 
=== Retrieving proton_fits from data_cubby ===
[CUBBY] ✅ Successfully retrieved proton_fits
[CUBBY] 
Plot Options for proton_fits:
[94m[CUBBY] Temp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Temp_tot', plot_type='scatter', var_name='Temp_tot', y_label='$Temp_{tot}$', legend_label='$T_{tot}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar1', plot_type='scatter', var_name='Tpar1', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar2', plot_type='scatter', var_name='Tpar2', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar_tot', plot_type='scatter', var_name='Tpar_tot', y_label='$T_\\parallel$', legend_label='$T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp1', plot_type='scatter', var_name='Tperp1', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp2', plot_type='scatter', var_name='Tperp2', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp_tot', plot_type='scatter', var_name='Tperp_tot', y_label='$T_{\\perp}$', legend_label='$T_{\\perp}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat1', plot_type='scatter', var_name='Trat1', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat2', plot_type='scatter', var_name='Trat2', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat_tot', plot_type='scatter', var_name='Trat_tot', y_label='$T_\\perp/T_\\parallel$', legend_label='$T_\\perp/T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] abs_qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='abs_qz_p', plot_type='scatter', var_name='abs_qz_p', y_label='$|Q_p| W/m^2$', legend_label='$|Q_p|$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] beta_ppar_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_ppar_pfits', plot_type='scatter', var_name='beta_ppar', y_label='$\\beta_{\\parallel,p}$', legend_label='$\\beta_{\\parallel,p}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] beta_pperp_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_pperp_pfits', plot_type='scatter', var_name='beta_pperp', y_label='$\\beta_{\\perp,p}$', legend_label='$\\beta_{\\perp,p}$', color='lightskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] chi_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p', plot_type='scatter', var_name='chi_p', y_label='$\\chi_p$', legend_label='$\\chi_p$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] chi_p_norm plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p_norm', plot_type='scatter', var_name='chi_p_norm', y_label='$\\chi_p norm$', legend_label='$\\chi_p norm$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] ham_param plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='ham_param', plot_type='scatter', var_name='ham_param', y_label='Hamplitude', legend_label='Hamplitude', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] n_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='n_tot', plot_type='scatter', var_name='n_tot', y_label='Density (cm$^{-3}$)', legend_label='$n_{ptot}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np1', plot_type='scatter', var_name='np1', y_label='Density (cm$^{-3}$)', legend_label='$n_{p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2', plot_type='scatter', var_name='np2', y_label='Density (cm$^{-3}$)', legend_label='$n_{p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2_np1_ratio plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2_np1_ratio', plot_type='scatter', var_name='np2_np1_ratio', y_label='$\\frac{n_{p2}}{n_{p1}}$', legend_label='$\\frac{n_{p2}}{n_{p1}}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='qz_p', plot_type='scatter', var_name='qz_p', y_label='$q_{z,p}$ (W/m$^2$)', legend_label='$q_{z,p}$', color='blueviolet', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] valfven_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='valfven_pfits', plot_type='time_series', var_name='valfven', y_label='V$_{A}$ (km/s)', legend_label='V$_{A}$', color=None, y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] vcm_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_mag', plot_type='scatter', var_name='vcm_mag', y_label='Velocity (km/s)', legend_label='$vmag_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_x', plot_type='scatter', var_name='vcm_x', y_label='Velocity (km/s)', legend_label='$vx_{cm}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_y', plot_type='scatter', var_name='vcm_y', y_label='Velocity (km/s)', legend_label='$vy_{cm}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_z', plot_type='scatter', var_name='vcm_z', y_label='Velocity (km/s)', legend_label='$vz_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift', plot_type='scatter', var_name='vdrift', y_label='$V_{drift}$', legend_label='$vdrift_{p2}$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_abs plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_abs', plot_type='scatter', var_name='vdrift_abs', y_label='$|V_{drift}|$', legend_label='$|vdrift_{p2}|$ ', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_va_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_va_pfits', plot_type='scatter', var_name='vdrift_va', y_label='$V_{drift}/V_A$', legend_label='$vdrift_{p2}/vA$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_mag', plot_type='scatter', var_name='vp1_mag', y_label='Velocity (km/s)', legend_label='$vmag_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_x', plot_type='scatter', var_name='vp1_x', y_label='Velocity (km/s)', legend_label='$vx_{p1}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_y', plot_type='scatter', var_name='vp1_y', y_label='Velocity (km/s)', legend_label='$vy_{p1}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_z', plot_type='scatter', var_name='vp1_z', y_label='Velocity (km/s)', legend_label='$vz_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vsw_mach_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vsw_mach_pfits', plot_type='scatter', var_name='vsw_mach', y_label='$V_{sw}/V_A$', legend_label='$V_{sw}/V_A$', color='gold', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: beta_ppar_pfits
Returning plot_manager instance for: beta_ppar_pfits
[CUBBY] 
=== Retrieving proton_fits from data_cubby ===
[CUBBY] ✅ Successfully retrieved proton_fits
[CUBBY] 
Plot Options for proton_fits:
[94m[CUBBY] Temp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Temp_tot', plot_type='scatter', var_name='Temp_tot', y_label='$Temp_{tot}$', legend_label='$T_{tot}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar1', plot_type='scatter', var_name='Tpar1', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar2', plot_type='scatter', var_name='Tpar2', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar_tot', plot_type='scatter', var_name='Tpar_tot', y_label='$T_\\parallel$', legend_label='$T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp1', plot_type='scatter', var_name='Tperp1', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp2', plot_type='scatter', var_name='Tperp2', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp_tot', plot_type='scatter', var_name='Tperp_tot', y_label='$T_{\\perp}$', legend_label='$T_{\\perp}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat1', plot_type='scatter', var_name='Trat1', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat2', plot_type='scatter', var_name='Trat2', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat_tot', plot_type='scatter', var_name='Trat_tot', y_label='$T_\\perp/T_\\parallel$', legend_label='$T_\\perp/T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] abs_qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='abs_qz_p', plot_type='scatter', var_name='abs_qz_p', y_label='$|Q_p| W/m^2$', legend_label='$|Q_p|$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] beta_ppar_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_ppar_pfits', plot_type='scatter', var_name='beta_ppar', y_label='$\\beta_{\\parallel,p}$', legend_label='$\\beta_{\\parallel,p}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] beta_pperp_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_pperp_pfits', plot_type='scatter', var_name='beta_pperp', y_label='$\\beta_{\\perp,p}$', legend_label='$\\beta_{\\perp,p}$', color='lightskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] chi_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p', plot_type='scatter', var_name='chi_p', y_label='$\\chi_p$', legend_label='$\\chi_p$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] chi_p_norm plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p_norm', plot_type='scatter', var_name='chi_p_norm', y_label='$\\chi_p norm$', legend_label='$\\chi_p norm$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] ham_param plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='ham_param', plot_type='scatter', var_name='ham_param', y_label='Hamplitude', legend_label='Hamplitude', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] n_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='n_tot', plot_type='scatter', var_name='n_tot', y_label='Density (cm$^{-3}$)', legend_label='$n_{ptot}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np1', plot_type='scatter', var_name='np1', y_label='Density (cm$^{-3}$)', legend_label='$n_{p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2', plot_type='scatter', var_name='np2', y_label='Density (cm$^{-3}$)', legend_label='$n_{p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2_np1_ratio plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2_np1_ratio', plot_type='scatter', var_name='np2_np1_ratio', y_label='$\\frac{n_{p2}}{n_{p1}}$', legend_label='$\\frac{n_{p2}}{n_{p1}}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='qz_p', plot_type='scatter', var_name='qz_p', y_label='$q_{z,p}$ (W/m$^2$)', legend_label='$q_{z,p}$', color='blueviolet', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] valfven_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='valfven_pfits', plot_type='time_series', var_name='valfven', y_label='V$_{A}$ (km/s)', legend_label='V$_{A}$', color=None, y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] vcm_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_mag', plot_type='scatter', var_name='vcm_mag', y_label='Velocity (km/s)', legend_label='$vmag_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_x', plot_type='scatter', var_name='vcm_x', y_label='Velocity (km/s)', legend_label='$vx_{cm}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_y', plot_type='scatter', var_name='vcm_y', y_label='Velocity (km/s)', legend_label='$vy_{cm}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_z', plot_type='scatter', var_name='vcm_z', y_label='Velocity (km/s)', legend_label='$vz_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift', plot_type='scatter', var_name='vdrift', y_label='$V_{drift}$', legend_label='$vdrift_{p2}$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_abs plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_abs', plot_type='scatter', var_name='vdrift_abs', y_label='$|V_{drift}|$', legend_label='$|vdrift_{p2}|$ ', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_va_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_va_pfits', plot_type='scatter', var_name='vdrift_va', y_label='$V_{drift}/V_A$', legend_label='$vdrift_{p2}/vA$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_mag', plot_type='scatter', var_name='vp1_mag', y_label='Velocity (km/s)', legend_label='$vmag_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_x', plot_type='scatter', var_name='vp1_x', y_label='Velocity (km/s)', legend_label='$vx_{p1}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_y', plot_type='scatter', var_name='vp1_y', y_label='Velocity (km/s)', legend_label='$vy_{p1}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_z', plot_type='scatter', var_name='vp1_z', y_label='Velocity (km/s)', legend_label='$vz_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vsw_mach_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vsw_mach_pfits', plot_type='scatter', var_name='vsw_mach', y_label='$V_{sw}/V_A$', legend_label='$V_{sw}/V_A$', color='gold', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: beta_pperp_pfits
Returning plot_manager instance for: beta_pperp_pfits
[CUBBY] 
=== Retrieving proton_fits from data_cubby ===
[CUBBY] ✅ Successfully retrieved proton_fits
[CUBBY] 
Plot Options for proton_fits:
[94m[CUBBY] Temp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Temp_tot', plot_type='scatter', var_name='Temp_tot', y_label='$Temp_{tot}$', legend_label='$T_{tot}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar1', plot_type='scatter', var_name='Tpar1', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar2', plot_type='scatter', var_name='Tpar2', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar_tot', plot_type='scatter', var_name='Tpar_tot', y_label='$T_\\parallel$', legend_label='$T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp1', plot_type='scatter', var_name='Tperp1', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp2', plot_type='scatter', var_name='Tperp2', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp_tot', plot_type='scatter', var_name='Tperp_tot', y_label='$T_{\\perp}$', legend_label='$T_{\\perp}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat1', plot_type='scatter', var_name='Trat1', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat2', plot_type='scatter', var_name='Trat2', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat_tot', plot_type='scatter', var_name='Trat_tot', y_label='$T_\\perp/T_\\parallel$', legend_label='$T_\\perp/T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] abs_qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='abs_qz_p', plot_type='scatter', var_name='abs_qz_p', y_label='$|Q_p| W/m^2$', legend_label='$|Q_p|$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] beta_ppar_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_ppar_pfits', plot_type='scatter', var_name='beta_ppar', y_label='$\\beta_{\\parallel,p}$', legend_label='$\\beta_{\\parallel,p}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] beta_pperp_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_pperp_pfits', plot_type='scatter', var_name='beta_pperp', y_label='$\\beta_{\\perp,p}$', legend_label='$\\beta_{\\perp,p}$', color='lightskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] chi_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p', plot_type='scatter', var_name='chi_p', y_label='$\\chi_p$', legend_label='$\\chi_p$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] chi_p_norm plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p_norm', plot_type='scatter', var_name='chi_p_norm', y_label='$\\chi_p norm$', legend_label='$\\chi_p norm$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] ham_param plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='ham_param', plot_type='scatter', var_name='ham_param', y_label='Hamplitude', legend_label='Hamplitude', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] n_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='n_tot', plot_type='scatter', var_name='n_tot', y_label='Density (cm$^{-3}$)', legend_label='$n_{ptot}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np1', plot_type='scatter', var_name='np1', y_label='Density (cm$^{-3}$)', legend_label='$n_{p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2', plot_type='scatter', var_name='np2', y_label='Density (cm$^{-3}$)', legend_label='$n_{p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2_np1_ratio plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2_np1_ratio', plot_type='scatter', var_name='np2_np1_ratio', y_label='$\\frac{n_{p2}}{n_{p1}}$', legend_label='$\\frac{n_{p2}}{n_{p1}}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='qz_p', plot_type='scatter', var_name='qz_p', y_label='$q_{z,p}$ (W/m$^2$)', legend_label='$q_{z,p}$', color='blueviolet', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] valfven_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='valfven_pfits', plot_type='time_series', var_name='valfven', y_label='V$_{A}$ (km/s)', legend_label='V$_{A}$', color=None, y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] vcm_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_mag', plot_type='scatter', var_name='vcm_mag', y_label='Velocity (km/s)', legend_label='$vmag_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_x', plot_type='scatter', var_name='vcm_x', y_label='Velocity (km/s)', legend_label='$vx_{cm}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_y', plot_type='scatter', var_name='vcm_y', y_label='Velocity (km/s)', legend_label='$vy_{cm}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_z', plot_type='scatter', var_name='vcm_z', y_label='Velocity (km/s)', legend_label='$vz_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift', plot_type='scatter', var_name='vdrift', y_label='$V_{drift}$', legend_label='$vdrift_{p2}$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_abs plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_abs', plot_type='scatter', var_name='vdrift_abs', y_label='$|V_{drift}|$', legend_label='$|vdrift_{p2}|$ ', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_va_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_va_pfits', plot_type='scatter', var_name='vdrift_va', y_label='$V_{drift}/V_A$', legend_label='$vdrift_{p2}/vA$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_mag', plot_type='scatter', var_name='vp1_mag', y_label='Velocity (km/s)', legend_label='$vmag_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_x', plot_type='scatter', var_name='vp1_x', y_label='Velocity (km/s)', legend_label='$vx_{p1}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_y', plot_type='scatter', var_name='vp1_y', y_label='Velocity (km/s)', legend_label='$vy_{p1}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_z', plot_type='scatter', var_name='vp1_z', y_label='Velocity (km/s)', legend_label='$vz_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vsw_mach_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vsw_mach_pfits', plot_type='scatter', var_name='vsw_mach', y_label='$V_{sw}/V_A$', legend_label='$V_{sw}/V_A$', color='gold', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: ham_param
Returning plot_manager instance for: ham_param
[35m[ZARR] TRACE: get_data function entry point[0m
[35m[ZARR] INPUT: trange=['2024-09-30/11:45:00.000', '2024-09-30/12:45:00.000'], variables=(plot_manager([ 5.50428623e-04,  1.30805058e-03,  1.59361358e-03, ...,
               2.61155675e-05,  4.64431665e-05, -4.29669930e-06]), plot_manager([       nan, 0.63251834, 0.61707829, ..., 0.98507619,
              0.88840602,        nan]), plot_manager([0.10429912, 0.12759895, 0.12680989, ..., 0.04479384,
              0.03627746, 0.03300291]), plot_manager([0.09480152, 0.10195357, 0.09493624, ..., 0.08742261,
              0.07353274, 0.07496672]), plot_manager([1.30475289, 1.50537321, 1.86537857, ..., 1.01032798,
              0.81860154, 0.30797241]))[0m
Variable type: <class 'plotbot.plot_manager.plot_manager'>, name: None
[35m[ZARR] [get_data] required_data_types: {'proton_fits'}[0m
[35m[ZARR] 
Processing Data Type: proton_fits...[0m
FITS Calculation required for ['2024-09-30/11:45:00.000', '2024-09-30/12:45:00.000'] (Triggered by proton_fits).
Import data function called
Input trange: ['2024-09-30/11:45:00.000', '2024-09-30/12:45:00.000']

Importing data for UTC time range: ['2024-09-30/11:45:00.000', '2024-09-30/12:45:00.000']

=== Starting FITS Raw Data Import for ['2024-09-30/11:45:00.000', '2024-09-30/12:45:00.000'] ===
daterange called with start_date=2024-09-30 11:45:00+00:00, end_date=2024-09-30 12:45:00+00:00
End date has time component, using full day: 2024-09-30
Converted start_date to date: 2024-09-30
Will generate 1 dates
Yielding date: 2024-09-30
Searching for SF00 FITS CSV for date: 20240930
 Searching sf00 in: psp_data/sweap/spi_fits/sf00/p2/v00 with patterns: ['spp_swp_spi_sf00_*.csv']
Searching for CSVs in 'psp_data/sweap/spi_fits/sf00/p2/v00' for patterns ['spp_swp_spi_sf00_*.csv'] and dates ['20240930', '2024-09-30']
  Found matching file: psp_data/sweap/spi_fits/sf00/p2/v00/2024/09/spp_swp_spi_sf00_2024-09-30_v00.csv
  Found sf00 file: 'spp_swp_spi_sf00_2024-09-30_v00.csv'
Consolidating raw FITS data...
Converted final times to TT2000 (Length: 37065)
Sorted all raw FITS data based on time.
[CUBBY] 
=== Update Debug ===
[CUBBY] Starting proton_fits_class update...
[CUBBY] Stored np1 state: {}
[CUBBY] Stored np2 state: {}
[CUBBY] Stored Tperp1 state: {}
[CUBBY] Stored Tperp2 state: {}
[CUBBY] Stored Trat1 state: {}
[CUBBY] Stored Trat2 state: {}
[CUBBY] Stored vdrift state: {}
proton_fits __getattr__ triggered for: B_inst_x
proton_fits __getattr__ triggered for: B_inst_y
proton_fits __getattr__ triggered for: B_inst_z
[CUBBY] Stored vp1_x state: {}
[CUBBY] Stored vp1_y state: {}
[CUBBY] Stored vp1_z state: {}
proton_fits __getattr__ triggered for: chi
[CUBBY] Stored qz_p state: {}
proton_fits __getattr__ triggered for: vsw_mach
proton_fits __getattr__ triggered for: beta_ppar
proton_fits __getattr__ triggered for: beta_pperp
[CUBBY] Stored ham_param state: {}
[CUBBY] Stored n_tot state: {}
[CUBBY] Stored np2_np1_ratio state: {}
[CUBBY] Stored vp1_mag state: {}
[CUBBY] Stored vcm_x state: {}
[CUBBY] Stored vcm_y state: {}
[CUBBY] Stored vcm_z state: {}
[CUBBY] Stored vcm_mag state: {}
[CUBBY] Stored vdrift_abs state: {}
proton_fits __getattr__ triggered for: vdrift_va
[CUBBY] Stored Trat_tot state: {}
[CUBBY] Stored Tpar1 state: {}
[CUBBY] Stored Tpar2 state: {}
[CUBBY] Stored Tpar_tot state: {}
[CUBBY] Stored Tperp_tot state: {}
[CUBBY] Stored Temp_tot state: {}
[CUBBY] Stored chi_p_norm state: {}
proton_fits __getattr__ triggered for: valfven
proton_fits __getattr__ triggered for: B_mag
proton_fits __getattr__ triggered for: bhat_x
proton_fits __getattr__ triggered for: bhat_y
proton_fits __getattr__ triggered for: bhat_z
proton_fits __getattr__ triggered for: vp2_x
proton_fits __getattr__ triggered for: vp2_y
proton_fits __getattr__ triggered for: vp2_z
proton_fits __getattr__ triggered for: vp2_mag
proton_fits __getattr__ triggered for: qz_p_perp
proton_fits __getattr__ triggered for: qz_p_par
proton_fits __getattr__ triggered for: Vcm_mach
proton_fits __getattr__ triggered for: Vp1_mach
proton_fits __getattr__ triggered for: beta_p_tot
[CUBBY] Stored chi_p state: {}
[CUBBY] Stored abs_qz_p state: {}
FITS Calculation: Determined dependency trange: ['2024-09-30/00:00:01.536000', '2024-09-30/23:59:54.893000']
FITS Calculation: Importing proton moment data directly...
Import data function called
Input trange: ['2024-09-30/00:00:01.536000', '2024-09-30/23:59:54.893000']

Importing data for UTC time range: ['2024-09-30/00:00:01.536000', '2024-09-30/23:59:54.893000']

=== Starting import for spi_sf00_l3_mom (CDF) ===
daterange called with start_date=2024-09-30 00:00:01.536000+00:00, end_date=2024-09-30 23:59:54.893000+00:00
End date has time component, using full day: 2024-09-30
Converted start_date to date: 2024-09-30
Will generate 1 dates
Yielding date: 2024-09-30
Found 1 unique CDF files to process.

Processing CDF file: psp_data/sweap/spi/l3/spi_sf00_l3_mom/2024/psp_swp_spi_sf00_L3_mom_20240930_v04.cdf
Successfully opened CDF file
Using time variable: Epoch
File time range (TT2000): 780926470720279936 to 781012867573061888
Reading full time data array...
Read 37066 time points
Time indices: 0 to 37064
Extracted 37064 time points within requested range

Reading variable: VEL_RTN_SUN
Raw data shape: (37064, 3)
Successfully stored data slice for VEL_RTN_SUN

Reading variable: DENS
Raw data shape: (37064,)
Successfully stored data slice for DENS

Reading variable: TEMP
Raw data shape: (37064,)
Successfully stored data slice for TEMP

Reading variable: MAGF_INST
Raw data shape: (37064, 3)
Successfully stored data slice for MAGF_INST

Reading variable: T_TENSOR_INST
Raw data shape: (37064, 6)
Successfully stored data slice for T_TENSOR_INST

Reading variable: EFLUX_VS_ENERGY
Raw data shape: (37064, 32)
Successfully stored data slice for EFLUX_VS_ENERGY

Reading variable: EFLUX_VS_THETA
Raw data shape: (37064, 8)
Successfully stored data slice for EFLUX_VS_THETA

Reading variable: EFLUX_VS_PHI
Raw data shape: (37064, 8)
Successfully stored data slice for EFLUX_VS_PHI

Reading variable: ENERGY_VALS
Raw data shape: (37064, 32)
Successfully stored data slice for ENERGY_VALS

Reading variable: THETA_VALS
Raw data shape: (37064, 8)
Successfully stored data slice for THETA_VALS

Reading variable: PHI_VALS
Raw data shape: (37064, 8)
Successfully stored data slice for PHI_VALS

Concatenating CDF data...
  Concatenated VEL_RTN_SUN (Shape: (37064, 3))
  Concatenated DENS (Shape: (37064,))
  Concatenated TEMP (Shape: (37064,))
  Concatenated MAGF_INST (Shape: (37064, 3))
  Concatenated T_TENSOR_INST (Shape: (37064, 6))
  Concatenated EFLUX_VS_ENERGY (Shape: (37064, 32))
  Concatenated EFLUX_VS_THETA (Shape: (37064, 8))
  Concatenated EFLUX_VS_PHI (Shape: (37064, 8))
  Concatenated ENERGY_VALS (Shape: (37064, 32))
  Concatenated THETA_VALS (Shape: (37064, 8))
  Concatenated PHI_VALS (Shape: (37064, 8))

Total CDF data points after concatenation: 37064
 Checking proton data availability post import_data_function call:
  proton_times length: 37064
  proton time range: 2024-09-30T00:00:01.536279936 to 2024-09-30T23:59:51.398520064
  Calculated vsw_mom_data length: 37064
  vsw_mom_data valid points: 37064
FITS Calculation: Proton data found. Aligning v_sw...
Alignment successful. Shape: (37065,)
[CUBBY] 
=== Stashing Debug (INSIDE DATA CUBBY)===
[CUBBY] Stashing with identifier: proton_fits
[CUBBY] Attributes before stash:

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Temp_tot: [32.85436731 36.5971535  36.15304018 35.56901045 37.34606272 33.37913263
 35.04240084 34.34615116 34.95028263 36.34419762]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tpar1: [19.68268856 32.90734178 32.35623581 30.9309475  32.32270294 30.37098545
 32.46929777 32.05443324 32.49094955 33.86442127]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tpar2: [ 36.44945758 131.03643854 136.4422925  133.31745743 126.02585007
 115.33318215 124.07184623 121.4989465  123.6212116  131.07481798]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tpar_tot: [34.97777915 42.25948048 43.43054939 40.78992798 41.49396362 38.71508157
 40.53653223 38.97995626 39.70150399 42.17461676]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tperp1: [29.34656297 33.53293609 32.03025502 32.52648251 35.00779771 30.22434854
 32.02590219 31.75957735 32.21915785 33.09420454]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tperp2: [34.80327909 40.33398175 44.73075948 43.99320584 42.00199796 41.85775557
 40.11226256 39.65583764 43.09204287 46.79509146]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Tperp_tot: [31.79266139 33.76599    32.51428557 32.95855168 35.27211228 30.71115816
 32.29533514 32.02924861 32.57467195 33.42898804]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Trat1: [1.49098345 1.01901078 0.98992526 1.05158377 1.08307148 0.99517181
 0.98634416 0.9908014  0.99163485 0.97725587]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Trat2: [0.95483668 0.30780737 0.32783647 0.32998834 0.33328081 0.36292899
 0.32329867 0.32638833 0.3485813  0.35701054]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - Trat_tot: [0.90893882 0.79901574 0.74865011 0.80800711 0.85005406 0.79326084
 0.79669704 0.82168508 0.82048962 0.79263288]...
[CUBBY] - _create_fits_scatter_ploptions: <bound method proton_fits_class._create_fits_scatter_ploptions of <plotbot.data_classes.psp_proton_fits_classes.proton_fits_class object at 0x14753c650>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - abs_qz_p: [0.00055043 0.00130805 0.00159361 0.0013678  0.00120113 0.00103693
 0.00108144 0.00084189 0.00094288 0.00126257]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - beta_ppar_pfits: [0.10429912 0.12759895 0.12680989 0.11977321 0.12386762 0.11399275
 0.1207028  0.11187264 0.11609583 0.12278073]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - beta_pperp_pfits: [0.09480152 0.10195357 0.09493624 0.0967776  0.10529417 0.09042598
 0.09616356 0.09192408 0.09525543 0.09732004]...
[CUBBY] - calculate_variables: <bound method proton_fits_class.calculate_variables of <plotbot.data_classes.psp_proton_fits_classes.proton_fits_class object at 0x14753c650>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - chi_p: [1090.08075774 1194.80102582 1060.77901829 1063.97085043 1245.91989974
 1361.46615755 1235.81570487 1174.87541843 1162.13944326 1221.33666806]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - chi_p_norm: [0.5348777  0.58626154 0.52050001 0.52206617 0.61134441 0.66804031
 0.60638651 0.5764845  0.57023525 0.59928198]...
[CUBBY] - datetime: []...
[CUBBY] - datetime_array: ['2024-09-30T00:00:01.536000000' '2024-09-30T00:00:03.283000000'
 '2024-09-30T00:00:05.031000000' '2024-09-30T00:00:06.779000000'
 '2024-09-30T00:00:08.526000000' '2024-09-30T00:00:10.274000000'
 '2024-09-30T00:00:12.022000000' '2024-09-30T00:00:13.769000000'
 '2024-09-30T00:00:15.517000000' '2024-09-30T00:00:17.264000000']...
[CUBBY] - get_subclass: <bound method proton_fits_class.get_subclass of <plotbot.data_classes.psp_proton_fits_classes.proton_fits_class object at 0x14753c650>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - ham_param: [1.30475289 1.50537321 1.86537857 1.67391473 1.41142762 1.7458341
 1.57210875 1.51959204 1.63008333 1.78392367]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - n_tot: [7851.59955539 7863.62744569 7706.18261927 7741.67196068 7726.74574061
 7787.69610166 7866.34822466 7638.07793284 7825.11161046 7703.1080859 ]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - np1: [4331.93959003 7594.16165139 7412.49130821 7449.96370779 7434.74788835
 7461.81346146 7604.24595466 7377.22405382 7569.25150436 7514.88133076]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - np2: [3519.65996536  269.46579429  293.69131106  291.70825289  291.99785226
  325.8826402   262.10227     260.85387902  255.8601061   188.22675515]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - np2_np1_ratio: [0.81249055 0.03548328 0.03962113 0.03915566 0.03927475 0.04367338
 0.03446788 0.03535935 0.03380256 0.0250472 ]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - qz_p: [0.00055043 0.00130805 0.00159361 0.0013678  0.00120113 0.00103693
 0.00108144 0.00084189 0.00094288 0.00126257]...
[CUBBY] - raw_data: {'np1': array([4331.93959003, 7594.16165139, 7412.49130821, ...,  476.58785091,
        550.35829121,  701.7589304 ]), 'np2': array([3519.65996536,  269.46579429,  293.69131106, ..., 1465.42689611,
       1417.69534123, 1164.97649813]), 'Tperp1': array([29.34656297, 33.53293609, 32.03025502, ..., 27.02898398,
       26.65600493, 51.64370739]), 'Tperp2': array([34.80327909, 40.33398175, 44.73075948, ..., 53.29636816,
       44.22945079, 36.12813124]), 'Trat1': array([1.49098345, 1.01901078, 0.98992526, ..., 2.58274346, 4.0251279 ,
       6.07445803]), 'Trat2': array([0.95483668, 0.30780737, 0.32783647, ..., 1.88865938, 1.88395344,
       1.90464838]), 'vdrift': array([ 54.89107756, 131.67405172, 136.28329283, ...,   8.60117924,
        17.34333725,  37.47261134]), 'B_inst_x': array([-1016.57 , -1014.86 , -1030.79 , ...,  -603.506,  -634.78 ,
        -639.815]), 'B_inst_y': array([ 165.582 ,   85.0561,   15.1704, ..., -206.956 , -143.047 ,
       -104.035 ]), 'B_inst_z': array([  17.6946,  111.262 ,   29.3583, ..., -111.199 ,  -25.4051,
        -29.879 ]), 'vp1_x': array([-166.23724772, -187.36287522, -187.00118281, ..., -204.12380316,
       -183.60104044, -167.54797628]), 'vp1_y': array([135.65288612, 145.61436943, 155.64844731, ..., 157.78979287,
       131.40460181, 115.90263404]), 'vp1_z': array([ 55.15988672,  42.49875274,  56.67156082, ..., 178.56867505,
       135.16918891, 124.17588795]), 'chi': array([1090.08075774, 1194.80102582, 1060.77901829, ...,  566.43351883,
        551.99678326,  470.09627361]), 'qz_p': array([ 5.50428623e-04,  1.30805058e-03,  1.59361358e-03, ...,
        2.61155675e-05,  4.64431665e-05, -4.29669930e-06]), 'vsw_mach': array([       nan, 0.63251834, 0.61707829, ..., 0.98507619, 0.88840602,
              nan]), 'beta_ppar': array([0.10429912, 0.12759895, 0.12680989, ..., 0.04479384, 0.03627746,
       0.03300291]), 'beta_pperp': array([0.09480152, 0.10195357, 0.09493624, ..., 0.08742261, 0.07353274,
       0.07496672]), 'ham_param': array([1.30475289, 1.50537321, 1.86537857, ..., 1.01032798, 0.81860154,
       0.30797241]), 'n_tot': array([7851.59955539, 7863.62744569, 7706.18261927, ..., 1942.01474702,
       1968.05363243, 1866.73542853]), 'np2_np1_ratio': array([0.81249055, 0.03548328, 0.03962113, ..., 3.07483058, 2.57594982,
       1.66008076]), 'vp1_mag': array([221.53812572, 241.06956585, 249.81502622, ..., 313.7688918 ,
       263.14866722, 238.59043586]), 'vcm_x': array([-190.51979446, -191.83263859, -192.19242575, ..., -210.17204279,
       -195.77947747, -190.60593406]), 'vcm_y': array([139.60810087, 145.98898331, 155.72484816, ..., 155.71571327,
       128.66020393, 112.15337115]), 'vcm_z': array([ 55.58255309,  42.98878567,  56.81941447, ..., 177.45425664,
       134.68178475, 123.09909432]), 'vcm_mag': array([242.64713911, 244.86849566, 253.80426062, ..., 316.08493183,
       270.22626634, 253.10548746]), 'vdrift_abs': array([ 54.89107756, 131.67405172, 136.28329283, ...,   8.60117924,
        17.34333725,  37.47261134]), 'vdrift_va': array([0.21658928, 0.52282056, 0.53212359, ..., 0.0268476 , 0.05419813,
       0.1144503 ]), 'Trat_tot': array([0.90893882, 0.79901574, 0.74865011, ..., 1.95166607, 2.02695418,
       2.27151849]), 'Tpar1': array([19.68268856, 32.90734178, 32.35623581, ..., 10.46522211,
        6.62239949,  8.50178026]), 'Tpar2': array([ 36.44945758, 131.03643854, 136.4422925 , ...,  28.21915306,
        23.47693413,  18.96839942]), 'Tpar_tot': array([34.97777915, 42.25948048, 43.43054939, ..., 24.00519074,
       19.39614998, 18.47261106]), 'Tperp_tot': array([31.79266139, 33.76599   , 32.51428557, ..., 46.8501163 ,
       39.31510726, 41.96087752]), 'Temp_tot': array([32.85436731, 36.5971535 , 36.15304018, ..., 39.23514111,
       32.67545483, 34.13145536]), '|qz_p|': None, 'chi_p_norm': array([0.5348777 , 0.58626154, 0.52050001, ..., 0.27793598, 0.2708522 ,
       0.23066549]), 'valfven': array([253.43395527, 251.85324178, 256.11210647, ..., 320.37046215,
       319.99880826, 327.41384449]), 'B_mag': array([1030.11895551, 1024.47771688, 1031.31957943, ...,  647.62295788,
        651.19391253,  648.90621055]), 'bhat_x': array([-0.98684719, -0.99061208, -0.9994865 , ..., -0.93187864,
       -0.97479412, -0.98598995]), 'bhat_y': array([ 0.16074066,  0.08302387,  0.0147097 , ..., -0.31956248,
       -0.21966882, -0.16032363]), 'bhat_z': array([ 0.01717724,  0.10860363,  0.02846673, ..., -0.1717033 ,
       -0.03901311, -0.04604517]), 'vp2_x': array([-220.40635355, -317.80078121, -323.21449459, ..., -212.13905836,
       -200.50722369, -204.49559434]), 'vp2_y': array([144.47611412, 156.54645817, 157.65313345, ..., 155.04117868,
       127.59481133, 109.89488892]), 'vp2_z': array([ 56.10276391,  56.79903288,  60.55110105, ..., 177.09182418,
       134.49257138, 122.45045501]), 'vp2_mag': array([269.44355319, 358.78999462, 364.67596005, ..., 316.86315873,
       273.07843999, 262.46799547]), 'qz_p_perp': array([ 1.41264910e-11,  3.06241563e-11,  4.02915669e-11, ...,
        1.51482579e-12,  3.45801960e-12, -3.05891285e-13]), 'qz_p_par': array([ 1.22415462e-11,  2.18724349e-11,  2.60995185e-11, ...,
        4.13019882e-12,  9.97914534e-12, -1.04722865e-12]), 'Vcm_mach': array([0.95743737, 0.9722666 , 0.99098892, ..., 0.9866232 , 0.84446023,
       0.77304455]), 'Vp1_mach': array([0.8741454 , 0.9571827 , 0.9754128 , ..., 0.97939395, 0.82234265,
       0.72871212]), 'beta_p_tot': array([0.14094551, 0.16332796, 0.15840972, ..., 0.09823034, 0.08199462,
       0.08190971]), 'chi_p': array([1090.08075774, 1194.80102582, 1060.77901829, ...,  566.43351883,
        551.99678326,  470.09627361]), 'abs_qz_p': array([5.50428623e-04, 1.30805058e-03, 1.59361358e-03, ...,
       2.61155675e-05, 4.64431665e-05, 4.29669930e-06])}
[CUBBY] - set_ploptions: <bound method proton_fits_class.set_ploptions of <plotbot.data_classes.psp_proton_fits_classes.proton_fits_class object at 0x14753c650>>
[CUBBY] - time: [780926470720000000 780926472467000000 780926474215000000
 780926475963000000 780926477710000000 780926479458000000
 780926481206000000 780926482953000000 780926484701000000
 780926486448000000]...
[CUBBY] - update: <bound method proton_fits_class.update of <plotbot.data_classes.psp_proton_fits_classes.proton_fits_class object at 0x14753c650>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - valfven_pfits: [253.43395527 251.85324178 256.11210647 255.39103113 253.29264797
 255.04128905 253.61424854 258.3257811  255.9199708  256.48943983]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vcm_mag: [242.64713911 244.86849566 253.80426062 248.17842513 244.71102801
 242.058597   241.18275982 239.10515648 236.07590773 247.21746364]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vcm_x: [-190.51979446 -191.83263859 -192.19242575 -193.72640328 -194.52802203
 -191.71752009 -195.0448717  -194.84766723 -197.21145467 -194.43952019]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vcm_y: [139.60810087 145.98898331 155.72484816 141.80941558 138.82171704
 139.26582041 133.32214975 132.1041075  122.97774325 147.59063725]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vcm_z: [55.58255309 42.98878567 56.81941447 62.87050999 52.63902306 49.41445272
 48.49562912 41.88277946 41.42403917 39.07366264]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vdrift: [ 54.89107756 131.67405172 136.28329283 125.91267915 121.78887617
 106.96506964 122.12998097 106.02651981 113.20075763 154.43371403]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vdrift_abs: [ 54.89107756 131.67405172 136.28329283 125.91267915 121.78887617
 106.96506964 122.12998097 106.02651981 113.20075763 154.43371403]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vdrift_va_pfits: [0.21658928 0.52282056 0.53212359 0.49301919 0.48082278 0.41940295
 0.48155804 0.41043724 0.44232874 0.60210555]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vp1_mag: [221.53812572 241.06956585 249.81502622 244.23416116 240.71935525
 238.12788252 237.48886446 235.74905759 232.56040324 243.96368944]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vp1_x: [-166.23724772 -187.36287522 -187.00118281 -189.01089134 -189.9687985
 -187.30046138 -191.05799364 -191.32729007 -193.64050178 -190.70724786]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vp1_y: [135.65288612 145.61436943 155.64844731 141.29157919 138.20778805
 138.57353766 132.52809482 131.30164262 122.05130502 147.12675993]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vp1_z: [55.15988672 42.49875274 56.67156082 62.94361032 52.50019912 49.20162864
 48.31260589 41.60967287 41.12391239 38.76524075]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - vsw_mach_pfits: [       nan 0.63251834 0.61707829 0.6273622  0.63853201 0.62196108
 0.64022594 0.63057191 0.65155278 0.62887996]...
[CUBBY] Stored in class_registry: proton_fits
[CUBBY] === End Stashing Debug (LEAVING DATA CUBBY)===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=qz_p[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vsw_mach_pfits[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=beta_ppar_pfits[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=beta_pperp_pfits[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=ham_param[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=np1[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=np2[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=n_tot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=np2_np1_ratio[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_x[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_y[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_z[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vp1_mag[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_x[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_y[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_z[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vcm_mag[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vdrift[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vdrift_abs[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=vdrift_va_pfits[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Trat1[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Trat2[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Trat_tot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tpar1[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tpar2[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tpar_tot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tperp1[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tperp2[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Tperp_tot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=Temp_tot[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=abs_qz_p[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=chi_p[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=chi_p_norm[0m

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=proton_fits, class=proton_fits, subclass=valfven_pfits[0m
[CUBBY] Restoring saved state...
[CUBBY] Restored np1 state: {}
[CUBBY] Restored np2 state: {}
[CUBBY] Restored Tperp1 state: {}
[CUBBY] Restored Tperp2 state: {}
[CUBBY] Restored Trat1 state: {}
[CUBBY] Restored Trat2 state: {}
[CUBBY] Restored vdrift state: {}
[CUBBY] Restored vp1_x state: {}
[CUBBY] Restored vp1_y state: {}
[CUBBY] Restored vp1_z state: {}
[CUBBY] Restored qz_p state: {}
[CUBBY] Restored ham_param state: {}
[CUBBY] Restored n_tot state: {}
[CUBBY] Restored np2_np1_ratio state: {}
[CUBBY] Restored vp1_mag state: {}
[CUBBY] Restored vcm_x state: {}
[CUBBY] Restored vcm_y state: {}
[CUBBY] Restored vcm_z state: {}
[CUBBY] Restored vcm_mag state: {}
[CUBBY] Restored vdrift_abs state: {}
[CUBBY] Restored Trat_tot state: {}
[CUBBY] Restored Tpar1 state: {}
[CUBBY] Restored Tpar2 state: {}
[CUBBY] Restored Tpar_tot state: {}
[CUBBY] Restored Tperp_tot state: {}
[CUBBY] Restored Temp_tot state: {}
[CUBBY] Restored chi_p_norm state: {}
[CUBBY] Restored chi_p state: {}
[CUBBY] Restored abs_qz_p state: {}
[CUBBY] === End Update Debug ===

[CUBBY] 
=== Retrieving proton_fits from data_cubby ===
[CUBBY] ✅ Successfully retrieved proton_fits
[CUBBY] 
Plot Options for proton_fits:
[94m[CUBBY] Temp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Temp_tot', plot_type='scatter', var_name='Temp_tot', y_label='$Temp_{tot}$', legend_label='$T_{tot}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar1', plot_type='scatter', var_name='Tpar1', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar2', plot_type='scatter', var_name='Tpar2', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar_tot', plot_type='scatter', var_name='Tpar_tot', y_label='$T_\\parallel$', legend_label='$T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp1', plot_type='scatter', var_name='Tperp1', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp2', plot_type='scatter', var_name='Tperp2', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp_tot', plot_type='scatter', var_name='Tperp_tot', y_label='$T_{\\perp}$', legend_label='$T_{\\perp}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat1', plot_type='scatter', var_name='Trat1', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat2', plot_type='scatter', var_name='Trat2', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat_tot', plot_type='scatter', var_name='Trat_tot', y_label='$T_\\perp/T_\\parallel$', legend_label='$T_\\perp/T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] abs_qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='abs_qz_p', plot_type='scatter', var_name='abs_qz_p', y_label='$|Q_p| W/m^2$', legend_label='$|Q_p|$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] beta_ppar_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_ppar_pfits', plot_type='scatter', var_name='beta_ppar', y_label='$\\beta_{\\parallel,p}$', legend_label='$\\beta_{\\parallel,p}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] beta_pperp_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_pperp_pfits', plot_type='scatter', var_name='beta_pperp', y_label='$\\beta_{\\perp,p}$', legend_label='$\\beta_{\\perp,p}$', color='lightskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] chi_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p', plot_type='scatter', var_name='chi_p', y_label='$\\chi_p$', legend_label='$\\chi_p$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] chi_p_norm plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p_norm', plot_type='scatter', var_name='chi_p_norm', y_label='$\\chi_p norm$', legend_label='$\\chi_p norm$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] ham_param plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='ham_param', plot_type='scatter', var_name='ham_param', y_label='Hamplitude', legend_label='Hamplitude', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] n_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='n_tot', plot_type='scatter', var_name='n_tot', y_label='Density (cm$^{-3}$)', legend_label='$n_{ptot}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np1', plot_type='scatter', var_name='np1', y_label='Density (cm$^{-3}$)', legend_label='$n_{p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2', plot_type='scatter', var_name='np2', y_label='Density (cm$^{-3}$)', legend_label='$n_{p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2_np1_ratio plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2_np1_ratio', plot_type='scatter', var_name='np2_np1_ratio', y_label='$\\frac{n_{p2}}{n_{p1}}$', legend_label='$\\frac{n_{p2}}{n_{p1}}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='qz_p', plot_type='scatter', var_name='qz_p', y_label='$q_{z,p}$ (W/m$^2$)', legend_label='$q_{z,p}$', color='blueviolet', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] valfven_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='valfven_pfits', plot_type='time_series', var_name='valfven', y_label='V$_{A}$ (km/s)', legend_label='V$_{A}$', color=None, y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] vcm_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_mag', plot_type='scatter', var_name='vcm_mag', y_label='Velocity (km/s)', legend_label='$vmag_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_x', plot_type='scatter', var_name='vcm_x', y_label='Velocity (km/s)', legend_label='$vx_{cm}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_y', plot_type='scatter', var_name='vcm_y', y_label='Velocity (km/s)', legend_label='$vy_{cm}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_z', plot_type='scatter', var_name='vcm_z', y_label='Velocity (km/s)', legend_label='$vz_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift', plot_type='scatter', var_name='vdrift', y_label='$V_{drift}$', legend_label='$vdrift_{p2}$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_abs plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_abs', plot_type='scatter', var_name='vdrift_abs', y_label='$|V_{drift}|$', legend_label='$|vdrift_{p2}|$ ', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_va_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_va_pfits', plot_type='scatter', var_name='vdrift_va', y_label='$V_{drift}/V_A$', legend_label='$vdrift_{p2}/vA$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_mag', plot_type='scatter', var_name='vp1_mag', y_label='Velocity (km/s)', legend_label='$vmag_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_x', plot_type='scatter', var_name='vp1_x', y_label='Velocity (km/s)', legend_label='$vx_{p1}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_y', plot_type='scatter', var_name='vp1_y', y_label='Velocity (km/s)', legend_label='$vy_{p1}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_z', plot_type='scatter', var_name='vp1_z', y_label='Velocity (km/s)', legend_label='$vz_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vsw_mach_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vsw_mach_pfits', plot_type='scatter', var_name='vsw_mach', y_label='$V_{sw}/V_A$', legend_label='$V_{sw}/V_A$', color='gold', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: qz_p
Returning plot_manager instance for: qz_p

DEBUG:
var: [ 5.50428623e-04  1.30805058e-03  1.59361358e-03 ...  2.61155675e-05
  4.64431665e-05 -4.29669930e-06]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2024-09-30T00:00:01.536000000
Time range: 2024-09-30T00:00:01.536000000 to 2024-09-30T23:59:54.893000000
var.data type: <class 'numpy.ndarray'>
var.data shape: (37065,)

Variable verification for proton_fits.qz_p:
Plot attributes example:
- Color: blueviolet
- Y-label: $q_{z,p}$ (W/m$^2$)
- Legend: $q_{z,p}$
[CUBBY] 
=== Retrieving proton_fits from data_cubby ===
[CUBBY] ✅ Successfully retrieved proton_fits
[CUBBY] 
Plot Options for proton_fits:
[94m[CUBBY] Temp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Temp_tot', plot_type='scatter', var_name='Temp_tot', y_label='$Temp_{tot}$', legend_label='$T_{tot}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar1', plot_type='scatter', var_name='Tpar1', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar2', plot_type='scatter', var_name='Tpar2', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar_tot', plot_type='scatter', var_name='Tpar_tot', y_label='$T_\\parallel$', legend_label='$T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp1', plot_type='scatter', var_name='Tperp1', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp2', plot_type='scatter', var_name='Tperp2', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp_tot', plot_type='scatter', var_name='Tperp_tot', y_label='$T_{\\perp}$', legend_label='$T_{\\perp}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat1', plot_type='scatter', var_name='Trat1', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat2', plot_type='scatter', var_name='Trat2', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat_tot', plot_type='scatter', var_name='Trat_tot', y_label='$T_\\perp/T_\\parallel$', legend_label='$T_\\perp/T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] abs_qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='abs_qz_p', plot_type='scatter', var_name='abs_qz_p', y_label='$|Q_p| W/m^2$', legend_label='$|Q_p|$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] beta_ppar_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_ppar_pfits', plot_type='scatter', var_name='beta_ppar', y_label='$\\beta_{\\parallel,p}$', legend_label='$\\beta_{\\parallel,p}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] beta_pperp_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_pperp_pfits', plot_type='scatter', var_name='beta_pperp', y_label='$\\beta_{\\perp,p}$', legend_label='$\\beta_{\\perp,p}$', color='lightskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] chi_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p', plot_type='scatter', var_name='chi_p', y_label='$\\chi_p$', legend_label='$\\chi_p$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] chi_p_norm plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p_norm', plot_type='scatter', var_name='chi_p_norm', y_label='$\\chi_p norm$', legend_label='$\\chi_p norm$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] ham_param plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='ham_param', plot_type='scatter', var_name='ham_param', y_label='Hamplitude', legend_label='Hamplitude', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] n_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='n_tot', plot_type='scatter', var_name='n_tot', y_label='Density (cm$^{-3}$)', legend_label='$n_{ptot}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np1', plot_type='scatter', var_name='np1', y_label='Density (cm$^{-3}$)', legend_label='$n_{p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2', plot_type='scatter', var_name='np2', y_label='Density (cm$^{-3}$)', legend_label='$n_{p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2_np1_ratio plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2_np1_ratio', plot_type='scatter', var_name='np2_np1_ratio', y_label='$\\frac{n_{p2}}{n_{p1}}$', legend_label='$\\frac{n_{p2}}{n_{p1}}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='qz_p', plot_type='scatter', var_name='qz_p', y_label='$q_{z,p}$ (W/m$^2$)', legend_label='$q_{z,p}$', color='blueviolet', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] valfven_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='valfven_pfits', plot_type='time_series', var_name='valfven', y_label='V$_{A}$ (km/s)', legend_label='V$_{A}$', color=None, y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] vcm_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_mag', plot_type='scatter', var_name='vcm_mag', y_label='Velocity (km/s)', legend_label='$vmag_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_x', plot_type='scatter', var_name='vcm_x', y_label='Velocity (km/s)', legend_label='$vx_{cm}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_y', plot_type='scatter', var_name='vcm_y', y_label='Velocity (km/s)', legend_label='$vy_{cm}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_z', plot_type='scatter', var_name='vcm_z', y_label='Velocity (km/s)', legend_label='$vz_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift', plot_type='scatter', var_name='vdrift', y_label='$V_{drift}$', legend_label='$vdrift_{p2}$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_abs plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_abs', plot_type='scatter', var_name='vdrift_abs', y_label='$|V_{drift}|$', legend_label='$|vdrift_{p2}|$ ', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_va_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_va_pfits', plot_type='scatter', var_name='vdrift_va', y_label='$V_{drift}/V_A$', legend_label='$vdrift_{p2}/vA$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_mag', plot_type='scatter', var_name='vp1_mag', y_label='Velocity (km/s)', legend_label='$vmag_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_x', plot_type='scatter', var_name='vp1_x', y_label='Velocity (km/s)', legend_label='$vx_{p1}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_y', plot_type='scatter', var_name='vp1_y', y_label='Velocity (km/s)', legend_label='$vy_{p1}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_z', plot_type='scatter', var_name='vp1_z', y_label='Velocity (km/s)', legend_label='$vz_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vsw_mach_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vsw_mach_pfits', plot_type='scatter', var_name='vsw_mach', y_label='$V_{sw}/V_A$', legend_label='$V_{sw}/V_A$', color='gold', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: vsw_mach_pfits
Returning plot_manager instance for: vsw_mach_pfits

DEBUG:
var: [       nan 0.63251834 0.61707829 ... 0.98507619 0.88840602        nan]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2024-09-30T00:00:01.536000000
Time range: 2024-09-30T00:00:01.536000000 to 2024-09-30T23:59:54.893000000
var.data type: <class 'numpy.ndarray'>
var.data shape: (37065,)

Variable verification for proton_fits.vsw_mach_pfits:
Plot attributes example:
- Color: gold
- Y-label: $V_{sw}/V_A$
- Legend: $V_{sw}/V_A$
[CUBBY] 
=== Retrieving proton_fits from data_cubby ===
[CUBBY] ✅ Successfully retrieved proton_fits
[CUBBY] 
Plot Options for proton_fits:
[94m[CUBBY] Temp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Temp_tot', plot_type='scatter', var_name='Temp_tot', y_label='$Temp_{tot}$', legend_label='$T_{tot}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar1', plot_type='scatter', var_name='Tpar1', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar2', plot_type='scatter', var_name='Tpar2', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar_tot', plot_type='scatter', var_name='Tpar_tot', y_label='$T_\\parallel$', legend_label='$T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp1', plot_type='scatter', var_name='Tperp1', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp2', plot_type='scatter', var_name='Tperp2', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp_tot', plot_type='scatter', var_name='Tperp_tot', y_label='$T_{\\perp}$', legend_label='$T_{\\perp}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat1', plot_type='scatter', var_name='Trat1', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat2', plot_type='scatter', var_name='Trat2', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat_tot', plot_type='scatter', var_name='Trat_tot', y_label='$T_\\perp/T_\\parallel$', legend_label='$T_\\perp/T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] abs_qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='abs_qz_p', plot_type='scatter', var_name='abs_qz_p', y_label='$|Q_p| W/m^2$', legend_label='$|Q_p|$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] beta_ppar_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_ppar_pfits', plot_type='scatter', var_name='beta_ppar', y_label='$\\beta_{\\parallel,p}$', legend_label='$\\beta_{\\parallel,p}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] beta_pperp_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_pperp_pfits', plot_type='scatter', var_name='beta_pperp', y_label='$\\beta_{\\perp,p}$', legend_label='$\\beta_{\\perp,p}$', color='lightskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] chi_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p', plot_type='scatter', var_name='chi_p', y_label='$\\chi_p$', legend_label='$\\chi_p$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] chi_p_norm plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p_norm', plot_type='scatter', var_name='chi_p_norm', y_label='$\\chi_p norm$', legend_label='$\\chi_p norm$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] ham_param plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='ham_param', plot_type='scatter', var_name='ham_param', y_label='Hamplitude', legend_label='Hamplitude', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] n_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='n_tot', plot_type='scatter', var_name='n_tot', y_label='Density (cm$^{-3}$)', legend_label='$n_{ptot}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np1', plot_type='scatter', var_name='np1', y_label='Density (cm$^{-3}$)', legend_label='$n_{p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2', plot_type='scatter', var_name='np2', y_label='Density (cm$^{-3}$)', legend_label='$n_{p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2_np1_ratio plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2_np1_ratio', plot_type='scatter', var_name='np2_np1_ratio', y_label='$\\frac{n_{p2}}{n_{p1}}$', legend_label='$\\frac{n_{p2}}{n_{p1}}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='qz_p', plot_type='scatter', var_name='qz_p', y_label='$q_{z,p}$ (W/m$^2$)', legend_label='$q_{z,p}$', color='blueviolet', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] valfven_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='valfven_pfits', plot_type='time_series', var_name='valfven', y_label='V$_{A}$ (km/s)', legend_label='V$_{A}$', color=None, y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] vcm_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_mag', plot_type='scatter', var_name='vcm_mag', y_label='Velocity (km/s)', legend_label='$vmag_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_x', plot_type='scatter', var_name='vcm_x', y_label='Velocity (km/s)', legend_label='$vx_{cm}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_y', plot_type='scatter', var_name='vcm_y', y_label='Velocity (km/s)', legend_label='$vy_{cm}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_z', plot_type='scatter', var_name='vcm_z', y_label='Velocity (km/s)', legend_label='$vz_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift', plot_type='scatter', var_name='vdrift', y_label='$V_{drift}$', legend_label='$vdrift_{p2}$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_abs plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_abs', plot_type='scatter', var_name='vdrift_abs', y_label='$|V_{drift}|$', legend_label='$|vdrift_{p2}|$ ', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_va_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_va_pfits', plot_type='scatter', var_name='vdrift_va', y_label='$V_{drift}/V_A$', legend_label='$vdrift_{p2}/vA$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_mag', plot_type='scatter', var_name='vp1_mag', y_label='Velocity (km/s)', legend_label='$vmag_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_x', plot_type='scatter', var_name='vp1_x', y_label='Velocity (km/s)', legend_label='$vx_{p1}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_y', plot_type='scatter', var_name='vp1_y', y_label='Velocity (km/s)', legend_label='$vy_{p1}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_z', plot_type='scatter', var_name='vp1_z', y_label='Velocity (km/s)', legend_label='$vz_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vsw_mach_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vsw_mach_pfits', plot_type='scatter', var_name='vsw_mach', y_label='$V_{sw}/V_A$', legend_label='$V_{sw}/V_A$', color='gold', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: beta_ppar_pfits
Returning plot_manager instance for: beta_ppar_pfits

DEBUG:
var: [0.10429912 0.12759895 0.12680989 ... 0.04479384 0.03627746 0.03300291]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2024-09-30T00:00:01.536000000
Time range: 2024-09-30T00:00:01.536000000 to 2024-09-30T23:59:54.893000000
var.data type: <class 'numpy.ndarray'>
var.data shape: (37065,)

Variable verification for proton_fits.beta_ppar_pfits:
Plot attributes example:
- Color: hotpink
- Y-label: $\beta_{\parallel,p}$
- Legend: $\beta_{\parallel,p}$
[CUBBY] 
=== Retrieving proton_fits from data_cubby ===
[CUBBY] ✅ Successfully retrieved proton_fits
[CUBBY] 
Plot Options for proton_fits:
[94m[CUBBY] Temp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Temp_tot', plot_type='scatter', var_name='Temp_tot', y_label='$Temp_{tot}$', legend_label='$T_{tot}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar1', plot_type='scatter', var_name='Tpar1', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar2', plot_type='scatter', var_name='Tpar2', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar_tot', plot_type='scatter', var_name='Tpar_tot', y_label='$T_\\parallel$', legend_label='$T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp1', plot_type='scatter', var_name='Tperp1', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp2', plot_type='scatter', var_name='Tperp2', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp_tot', plot_type='scatter', var_name='Tperp_tot', y_label='$T_{\\perp}$', legend_label='$T_{\\perp}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat1', plot_type='scatter', var_name='Trat1', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat2', plot_type='scatter', var_name='Trat2', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat_tot', plot_type='scatter', var_name='Trat_tot', y_label='$T_\\perp/T_\\parallel$', legend_label='$T_\\perp/T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] abs_qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='abs_qz_p', plot_type='scatter', var_name='abs_qz_p', y_label='$|Q_p| W/m^2$', legend_label='$|Q_p|$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] beta_ppar_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_ppar_pfits', plot_type='scatter', var_name='beta_ppar', y_label='$\\beta_{\\parallel,p}$', legend_label='$\\beta_{\\parallel,p}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] beta_pperp_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_pperp_pfits', plot_type='scatter', var_name='beta_pperp', y_label='$\\beta_{\\perp,p}$', legend_label='$\\beta_{\\perp,p}$', color='lightskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] chi_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p', plot_type='scatter', var_name='chi_p', y_label='$\\chi_p$', legend_label='$\\chi_p$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] chi_p_norm plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p_norm', plot_type='scatter', var_name='chi_p_norm', y_label='$\\chi_p norm$', legend_label='$\\chi_p norm$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] ham_param plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='ham_param', plot_type='scatter', var_name='ham_param', y_label='Hamplitude', legend_label='Hamplitude', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] n_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='n_tot', plot_type='scatter', var_name='n_tot', y_label='Density (cm$^{-3}$)', legend_label='$n_{ptot}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np1', plot_type='scatter', var_name='np1', y_label='Density (cm$^{-3}$)', legend_label='$n_{p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2', plot_type='scatter', var_name='np2', y_label='Density (cm$^{-3}$)', legend_label='$n_{p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2_np1_ratio plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2_np1_ratio', plot_type='scatter', var_name='np2_np1_ratio', y_label='$\\frac{n_{p2}}{n_{p1}}$', legend_label='$\\frac{n_{p2}}{n_{p1}}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='qz_p', plot_type='scatter', var_name='qz_p', y_label='$q_{z,p}$ (W/m$^2$)', legend_label='$q_{z,p}$', color='blueviolet', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] valfven_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='valfven_pfits', plot_type='time_series', var_name='valfven', y_label='V$_{A}$ (km/s)', legend_label='V$_{A}$', color=None, y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] vcm_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_mag', plot_type='scatter', var_name='vcm_mag', y_label='Velocity (km/s)', legend_label='$vmag_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_x', plot_type='scatter', var_name='vcm_x', y_label='Velocity (km/s)', legend_label='$vx_{cm}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_y', plot_type='scatter', var_name='vcm_y', y_label='Velocity (km/s)', legend_label='$vy_{cm}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_z', plot_type='scatter', var_name='vcm_z', y_label='Velocity (km/s)', legend_label='$vz_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift', plot_type='scatter', var_name='vdrift', y_label='$V_{drift}$', legend_label='$vdrift_{p2}$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_abs plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_abs', plot_type='scatter', var_name='vdrift_abs', y_label='$|V_{drift}|$', legend_label='$|vdrift_{p2}|$ ', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_va_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_va_pfits', plot_type='scatter', var_name='vdrift_va', y_label='$V_{drift}/V_A$', legend_label='$vdrift_{p2}/vA$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_mag', plot_type='scatter', var_name='vp1_mag', y_label='Velocity (km/s)', legend_label='$vmag_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_x', plot_type='scatter', var_name='vp1_x', y_label='Velocity (km/s)', legend_label='$vx_{p1}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_y', plot_type='scatter', var_name='vp1_y', y_label='Velocity (km/s)', legend_label='$vy_{p1}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_z', plot_type='scatter', var_name='vp1_z', y_label='Velocity (km/s)', legend_label='$vz_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vsw_mach_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vsw_mach_pfits', plot_type='scatter', var_name='vsw_mach', y_label='$V_{sw}/V_A$', legend_label='$V_{sw}/V_A$', color='gold', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: beta_pperp_pfits
Returning plot_manager instance for: beta_pperp_pfits

DEBUG:
var: [0.09480152 0.10195357 0.09493624 ... 0.08742261 0.07353274 0.07496672]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2024-09-30T00:00:01.536000000
Time range: 2024-09-30T00:00:01.536000000 to 2024-09-30T23:59:54.893000000
var.data type: <class 'numpy.ndarray'>
var.data shape: (37065,)

Variable verification for proton_fits.beta_pperp_pfits:
Plot attributes example:
- Color: lightskyblue
- Y-label: $\beta_{\perp,p}$
- Legend: $\beta_{\perp,p}$
[CUBBY] 
=== Retrieving proton_fits from data_cubby ===
[CUBBY] ✅ Successfully retrieved proton_fits
[CUBBY] 
Plot Options for proton_fits:
[94m[CUBBY] Temp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Temp_tot', plot_type='scatter', var_name='Temp_tot', y_label='$Temp_{tot}$', legend_label='$T_{tot}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar1', plot_type='scatter', var_name='Tpar1', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar2', plot_type='scatter', var_name='Tpar2', y_label='$T_{\\parallel}$', legend_label='$T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tpar_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tpar_tot', plot_type='scatter', var_name='Tpar_tot', y_label='$T_\\parallel$', legend_label='$T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp1', plot_type='scatter', var_name='Tperp1', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp2', plot_type='scatter', var_name='Tperp2', y_label='$T_{\\perp}$', legend_label='$T_{\\perp,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Tperp_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Tperp_tot', plot_type='scatter', var_name='Tperp_tot', y_label='$T_{\\perp}$', legend_label='$T_{\\perp}$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat1', plot_type='scatter', var_name='Trat1', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat2', plot_type='scatter', var_name='Trat2', y_label='$T_{\\perp}/T_{\\parallel}$', legend_label='$T_{\\perp}/T_{\\parallel,p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] Trat_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='Trat_tot', plot_type='scatter', var_name='Trat_tot', y_label='$T_\\perp/T_\\parallel$', legend_label='$T_\\perp/T_\\parallel$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] abs_qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='abs_qz_p', plot_type='scatter', var_name='abs_qz_p', y_label='$|Q_p| W/m^2$', legend_label='$|Q_p|$', color='mediumspringgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] beta_ppar_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_ppar_pfits', plot_type='scatter', var_name='beta_ppar', y_label='$\\beta_{\\parallel,p}$', legend_label='$\\beta_{\\parallel,p}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] beta_pperp_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='beta_pperp_pfits', plot_type='scatter', var_name='beta_pperp', y_label='$\\beta_{\\perp,p}$', legend_label='$\\beta_{\\perp,p}$', color='lightskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] chi_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p', plot_type='scatter', var_name='chi_p', y_label='$\\chi_p$', legend_label='$\\chi_p$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] chi_p_norm plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='chi_p_norm', plot_type='scatter', var_name='chi_p_norm', y_label='$\\chi_p norm$', legend_label='$\\chi_p norm$', color='rebeccapurple', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] ham_param plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='ham_param', plot_type='scatter', var_name='ham_param', y_label='Hamplitude', legend_label='Hamplitude', color='palevioletred', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] n_tot plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='n_tot', plot_type='scatter', var_name='n_tot', y_label='Density (cm$^{-3}$)', legend_label='$n_{ptot}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np1 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np1', plot_type='scatter', var_name='np1', y_label='Density (cm$^{-3}$)', legend_label='$n_{p1}$', color='hotpink', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2 plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2', plot_type='scatter', var_name='np2', y_label='Density (cm$^{-3}$)', legend_label='$n_{p2}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] np2_np1_ratio plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='np2_np1_ratio', plot_type='scatter', var_name='np2_np1_ratio', y_label='$\\frac{n_{p2}}{n_{p1}}$', legend_label='$\\frac{n_{p2}}{n_{p1}}$', color='deepskyblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] qz_p plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='qz_p', plot_type='scatter', var_name='qz_p', y_label='$q_{z,p}$ (W/m$^2$)', legend_label='$q_{z,p}$', color='blueviolet', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[94m[CUBBY] valfven_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='valfven_pfits', plot_type='time_series', var_name='valfven', y_label='V$_{A}$ (km/s)', legend_label='V$_{A}$', color=None, y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] vcm_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_mag', plot_type='scatter', var_name='vcm_mag', y_label='Velocity (km/s)', legend_label='$vmag_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_x', plot_type='scatter', var_name='vcm_x', y_label='Velocity (km/s)', legend_label='$vx_{cm}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_y', plot_type='scatter', var_name='vcm_y', y_label='Velocity (km/s)', legend_label='$vy_{cm}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vcm_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vcm_z', plot_type='scatter', var_name='vcm_z', y_label='Velocity (km/s)', legend_label='$vz_{cm}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift', plot_type='scatter', var_name='vdrift', y_label='$V_{drift}$', legend_label='$vdrift_{p2}$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_abs plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_abs', plot_type='scatter', var_name='vdrift_abs', y_label='$|V_{drift}|$', legend_label='$|vdrift_{p2}|$ ', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vdrift_va_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vdrift_va_pfits', plot_type='scatter', var_name='vdrift_va', y_label='$V_{drift}/V_A$', legend_label='$vdrift_{p2}/vA$', color='navy', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_mag plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_mag', plot_type='scatter', var_name='vp1_mag', y_label='Velocity (km/s)', legend_label='$vmag_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_x plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_x', plot_type='scatter', var_name='vp1_x', y_label='Velocity (km/s)', legend_label='$vx_{p1}$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_y plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_y', plot_type='scatter', var_name='vp1_y', y_label='Velocity (km/s)', legend_label='$vy_{p1}$', color='orange', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vp1_z plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vp1_z', plot_type='scatter', var_name='vp1_z', y_label='Velocity (km/s)', legend_label='$vz_{p1}$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=5, alpha=0.7[0m
[94m[CUBBY] vsw_mach_pfits plot options: data_type='proton_fits', class_name='proton_fits', subclass_name='vsw_mach_pfits', plot_type='scatter', var_name='vsw_mach', y_label='$V_{sw}/V_A$', legend_label='$V_{sw}/V_A$', color='gold', y_scale='linear', y_limit=None, line_width=1.0, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None, marker_style='*', marker_size=20, alpha=0.7[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Attempting to get subclass/attribute: ham_param
Returning plot_manager instance for: ham_param

DEBUG:
var: [1.30475289 1.50537321 1.86537857 ... 1.01032798 0.81860154 0.30797241]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2024-09-30T00:00:01.536000000
Time range: 2024-09-30T00:00:01.536000000 to 2024-09-30T23:59:54.893000000
var.data type: <class 'numpy.ndarray'>
var.data shape: (37065,)

Variable verification for proton_fits.ham_param:
Plot attributes example:
- Color: palevioletred
- Y-label: Hamplitude
- Legend: Hamplitude
Setting title from plt.options: Multiplot Stardust Test
Plotbot call completed successfully (stardust FITS).
--- Verifying Data Availability Post-Plotbot Call (stardust FITS) ---
proton_fits_instance datetime_array loaded (stardust). Length: 37065.
✅ Variable 'qz_p' verified with data (stardust).
✅ Variable 'vsw_mach_pfits' verified with data (stardust).
✅ Variable 'beta_ppar_pfits' verified with data (stardust).
✅ Variable 'beta_pperp_pfits' verified with data (stardust).
✅ Variable 'ham_param' verified with data (stardust).
--- Stardust FITS Group Test Passed for: ['qz_p', 'vsw_mach_pfits', 'beta_ppar_pfits', 'beta_pperp_pfits', 'ham_param'] ---
PASSED
tests/test_stardust.py::test_stardust_audifier_initialization 
=== Testing Audifier Initialization (stardust) ===
✅ Audifier defaults checked (channels=1, rate=44100, fade=0)
PASSED
tests/test_stardust.py::test_stardust_sonify_valid_data Save Directory Set: /var/folders/3n/8nbttjbs573270nf5nvjg3cw0000gn/T/tmppjsinv7c

=== Testing Audifier Sonification (stardust) ===
🔵 PHASE 1: Setting audifier options (stardust)
🔵 PHASE 2: Generating audio with mag_rtn.br (stardust)
Starting audification process...

Processing mag_RTN - br
Attempting download for mag_RTN from Berkeley server
Downloading data for UTC time range: 2020-04-09 06:00:00+00:00 to 2020-04-09 07:00:00+00:00
Local Files Time Debug
Input trange: ['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000']
Parsed start time: 2020-04-09 06:00:00+00:00
Parsed end time: 2020-04-09 07:00:00+00:00
Checking local files for time range: ['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000'] and data type: mag_RTN
About to check dates between 2020-04-09 and 2020-04-09
daterange called with start_date=2020-04-09 06:00:00+00:00, end_date=2020-04-09 07:00:00+00:00
End date has time component, using full day: 2020-04-09
Converted start_date to date: 2020-04-09
Will generate 1 dates
Yielding date: 2020-04-09
Will check these dates: [datetime.date(2020, 4, 9)]
Data type mag_RTN uses downloaded CDF source.
daterange called with start_date=2020-04-09 06:00:00+00:00, end_date=2020-04-09 07:00:00+00:00
End date has time component, using full day: 2020-04-09
Converted start_date to date: 2020-04-09
Will generate 1 dates
Yielding date: 2020-04-09
Checking files for date: 20200409 in psp_data/fields/l2/mag_rtn/2020
  Relevant 6-hour blocks for 20200409: [1]
  Searching for 6-hour files matching: psp_fld_l2_mag_RTN_2020040906_v*.cdf in psp_data/fields/l2/mag_rtn/2020

Searching directory: psp_data/fields/l2/mag_rtn/2020
Found 2 total files in directory
First few files: ['psp_fld_l2_mag_RTN_2020040912_v02.cdf', 'psp_fld_l2_mag_RTN_2020040906_v02.cdf']
Searching for pattern: psp_fld_l2_mag_RTN_2020040906_v*.cdf
Modified pattern for matching: psp_fld_l2_mag_RTN_2020040906_v
Found 1 matching files
  - psp_fld_l2_mag_RTN_2020040906_v02.cdf
  ✓ Found 1 file(s) for interval 06:00

Summary (CDF mag_RTN):
Found files: 1
First few found: ['psp_data/fields/l2/mag_rtn/2020/psp_fld_l2_mag_RTN_2020040906_v02.cdf']
Missing files/dates: 0
[CUBBY] 
=== Retrieving mag_rtn from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn
[CUBBY] 
Plot Options for mag_rtn:
[94m[CUBBY] all plot options: data_type='mag_RTN', class_name='mag_rtn', subclass_name='all', plot_type='time_series', var_name=['br_rtn', 'bt_rtn', 'bn_rtn'], y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN', class_name='mag_rtn', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN', class_name='mag_rtn', subclass_name='bn', plot_type='time_series', var_name='bn_rtn', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN', class_name='mag_rtn', subclass_name='br', plot_type='time_series', var_name='br_rtn', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN', class_name='mag_rtn', subclass_name='bt', plot_type='time_series', var_name='bt_rtn', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN', class_name='mag_rtn', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Importing data for mag_RTN
Import data function called
Input trange: ['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000']

Importing data for UTC time range: ['2020-04-09/06:00:00.000', '2020-04-09/07:00:00.000']

=== Starting import for mag_RTN (CDF) ===
daterange called with start_date=2020-04-09 06:00:00+00:00, end_date=2020-04-09 07:00:00+00:00
End date has time component, using full day: 2020-04-09
Converted start_date to date: 2020-04-09
Will generate 1 dates
Yielding date: 2020-04-09
Found 1 unique CDF files to process.

Processing CDF file: psp_data/fields/l2/mag_rtn/2020/psp_fld_l2_mag_RTN_2020040906_v02.cdf
Successfully opened CDF file
Using time variable: epoch_mag_RTN
File time range (TT2000): 639684069242294656 to 639705669138014336
Reading full time data array...
Read 197753 time points
Time indices: 0 to 32959
Extracted 32959 time points within requested range

Reading variable: psp_fld_l2_mag_RTN
Raw data shape: (32959, 3)
Successfully stored data slice for psp_fld_l2_mag_RTN

Concatenating CDF data...
  Concatenated psp_fld_l2_mag_RTN (Shape: (32959, 3))

Total CDF data points after concatenation: 32959
[CUBBY] 
=== Update Debug ===
[CUBBY] Starting mag_rtn_class update...
[CUBBY] Stored all state: {}
[CUBBY] Stored br state: {}
[CUBBY] Stored bt state: {}
[CUBBY] Stored bn state: {}
[CUBBY] Stored bmag state: {}
[CUBBY] Stored pmag state: {}
Setting attribute: time with value: [639684069242294656 639684069351521408 639684069460748032 ...
 639687668933574784 639687669042801408 639687669152028160]
Setting attribute: datetime_array with value: ['2020-04-09T06:00:00.058294656' '2020-04-09T06:00:00.167521408'
 '2020-04-09T06:00:00.276748032' ... '2020-04-09T06:59:59.749574784'
 '2020-04-09T06:59:59.858801408' '2020-04-09T06:59:59.968028160']
self.datetime_array type after conversion: {type(self.datetime_array)}
First element type: {type(self.datetime_array[0])}
Setting attribute: field with value: [[-1.2450768  2.0269687 -1.5723084]
 [-1.2430027  1.9164598 -1.6100308]
 [-1.309545   1.9273013 -1.6576694]
 ...
 [-1.6721244  1.8439525 -3.1284304]
 [-1.744806   1.8992736 -3.1881316]
 [-1.8347967  1.869154  -3.171205 ]]
Setting attribute: raw_data with value: {'all': [array([-1.2450768, -1.2430027, -1.309545 , ..., -1.6721244, -1.744806 ,
       -1.8347967], dtype=float32), array([2.0269687, 1.9164598, 1.9273013, ..., 1.8439525, 1.8992736,
       1.869154 ], dtype=float32), array([-1.5723084, -1.6100308, -1.6576694, ..., -3.1284304, -3.1881316,
       -3.171205 ], dtype=float32)], 'br': array([-1.2450768, -1.2430027, -1.309545 , ..., -1.6721244, -1.744806 ,
       -1.8347967], dtype=float32), 'bt': array([2.0269687, 1.9164598, 1.9273013, ..., 1.8439525, 1.8992736,
       1.869154 ], dtype=float32), 'bn': array([-1.5723084, -1.6100308, -1.6576694, ..., -3.1284304, -3.1881316,
       -3.171205 ], dtype=float32), 'bmag': array([2.851486 , 2.7946508, 2.859592 , ..., 3.9979043, 4.1007037,
       4.1129985], dtype=float32), 'pmag': array([0.00323521, 0.00310753, 0.00325363, ..., 0.00635953, 0.00669078,
       0.00673096], dtype=float32)}

Debug - Data Arrays:
Time array shape: {self.time.shape}
Field data shape: (32959, 3)
First TT2000 time: 639684069242294656

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=all[0m
Setting attribute: all with value: [[-1.2450768 -1.2430027 -1.309545  ... -1.6721244 -1.744806  -1.8347967]
 [ 2.0269687  1.9164598  1.9273013 ...  1.8439525  1.8992736  1.869154 ]
 [-1.5723084 -1.6100308 -1.6576694 ... -3.1284304 -3.1881316 -3.171205 ]]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=br[0m
Setting attribute: br with value: [-1.2450768 -1.2430027 -1.309545  ... -1.6721244 -1.744806  -1.8347967]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=bt[0m
Setting attribute: bt with value: [2.0269687 1.9164598 1.9273013 ... 1.8439525 1.8992736 1.869154 ]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=bn[0m
Setting attribute: bn with value: [-1.5723084 -1.6100308 -1.6576694 ... -3.1284304 -3.1881316 -3.171205 ]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=bmag[0m
Setting attribute: bmag with value: [2.851486  2.7946508 2.859592  ... 3.9979043 4.1007037 4.1129985]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN, class=mag_rtn, subclass=pmag[0m
Setting attribute: pmag with value: [0.00323521 0.00310753 0.00325363 ... 0.00635953 0.00669078 0.00673096]
[CUBBY] Restoring saved state...
[CUBBY] Restored all state: {}
[CUBBY] Restored br state: {}
[CUBBY] Restored bt state: {}
[CUBBY] Restored bn state: {}
[CUBBY] Restored bmag state: {}
[CUBBY] Restored pmag state: {}
[CUBBY] === End Update Debug ===

Getting subclass: br
Returning br component

DEBUG CLIPPING:
Clipping data to range: 2020-04-09/06:00:00.000 to 2020-04-09/07:00:00.000
Original data points: 32959
Points in range: 32959

Creating encounter directory: /var/folders/3n/8nbttjbs573270nf5nvjg3cw0000gn/T/tmppjsinv7c/E5
Output directory: /var/folders/3n/8nbttjbs573270nf5nvjg3cw0000gn/T/tmppjsinv7c/E5/E5_2020_04_09_0600_to_0700
Generating markers for time range: 2020-04-09/06:00:00.000 to 2020-04-09/07:00:00.000
Number of time points: 32959
Data time range: 2020-04-09 06:00:00.058294656 to 2020-04-09 06:59:59.968028160
Total markers generated: 2
Marker file created: /var/folders/3n/8nbttjbs573270nf5nvjg3cw0000gn/T/tmppjsinv7c/E5/E5_2020_04_09_0600_to_0700/E5_PSP_FIELDS_MARKER_SET_2020-04-09_0600_to_0700_2_per_hour.txt

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

Saved mono audio file: /var/folders/3n/8nbttjbs573270nf5nvjg3cw0000gn/T/tmppjsinv7c/E5/E5_2020_04_09_0600_to_0700/E5_PSP_MAG_RTN_2020-04-09_0600_to_0700_44100SR_Br.wav
Button(description='Show Directory', style=ButtonStyle())
Button(description='Open markers', style=ButtonStyle())
Button(description='Open br', style=ButtonStyle())
Audify returned: {'markers': '/var/folders/3n/8nbttjbs573270nf5nvjg3cw0000gn/T/tmppjsinv7c/E5/E5_2020_04_09_0600_to_0700/E5_PSP_FIELDS_MARKER_SET_2020-04-09_0600_to_0700_2_per_hour.txt', 'br': '/var/folders/3n/8nbttjbs573270nf5nvjg3cw0000gn/T/tmppjsinv7c/E5/E5_2020_04_09_0600_to_0700/E5_PSP_MAG_RTN_2020-04-09_0600_to_0700_44100SR_Br.wav'}
🔵 PHASE 3: Verifying audio file creation (stardust)
✅ Audio file created and verified: E5_PSP_MAG_RTN_2020-04-09_0600_to_0700_44100SR_Br.wav
PASSEDSave Directory Set: /Users/robertalexander/Dropbox/__Collaborations/_NASA/__HCS_Crossing_Catalogue/HCS_Crossings/E23

tests/test_stardust.py::test_stardust_custom_arithmetic 🔵 PHASE 1: Creating arithmetic custom variable (stardust)

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=custom_data_type, class=custom_class, subclass=br_bt_add[0m
DEBUG custom_variable: Incoming expression for 'br_bt_add' already has data? True (24719 points)
Expression type: <class 'plotbot.plot_manager.plot_manager'>
Expression has source_var: True
Source var is None: False
Source var type: <class 'list'>
Source var length: 2
[CUBBY] 
=== Retrieving custom_class from data_cubby ===
[CUBBY] ✅ Successfully retrieved custom_class
[CUBBY] 
Plot Options for custom_class:
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

DEBUG custom_variable: Incoming expression for 'Mag_Sum_RT' already has data? True (24719 points)
Expression type: <class 'plotbot.plot_manager.plot_manager'>
Expression has source_var: True
Source var is None: False
Source var type: <class 'list'>
Source var length: 2
[CUBBY] 
=== Retrieving custom_class from data_cubby ===
[CUBBY] ✅ Successfully retrieved custom_class
[CUBBY] 
Plot Options for custom_class:
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

🔵 PHASE 2: Calling plotbot to trigger data load (stardust)
User explicitly set hspace to 0.25
User explicitly set hspace to 0.25

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {'subclass_name': 'Mag_Sum_RT', 'legend_label': 'Mag_Sum_RT', 'class_name': 'custom_class', 'data_type': 'custom_data_type'}
=== End Array Finalize Status ===

[CUBBY] 
=== Retrieving custom_class from data_cubby ===
[CUBBY] ✅ Successfully retrieved custom_class
[CUBBY] 
Plot Options for custom_class:
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Adding source variable for data download: mag_rtn_4sa.br
Adding source variable for data download: mag_rtn_4sa.bt
[35m[ZARR] TRACE: get_data function entry point[0m
[35m[ZARR] INPUT: trange=['2023-09-28/06:00:00.000', '2023-09-28/07:30:00.000'], variables=(plot_manager([-1126.1879, -1120.4971, -1119.7444, ..., -1381.3326,
              -1389.332 , -1392.3956], dtype=float32), plot_manager([359.4798 , 352.0624 , 351.09058, ..., 173.14677, 146.52287,
              121.04443], dtype=float32))[0m
Variable type: <class 'plotbot.plot_manager.plot_manager'>, name: None
[35m[ZARR] [get_data] required_data_types: {'mag_RTN_4sa'}[0m
[35m[ZARR] 
Processing Data Type: mag_RTN_4sa...[0m
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

[35m[ZARR] [get_data] mag_RTN_4sa: needs_import=True, needs_refresh=True[0m
[35m[ZARR] [get_data] Import/Refresh logic triggered for mag_RTN_4sa[0m
[35m[ZARR] [load_data] Called for data_type=mag_RTN_4sa, trange=['2023-09-28/06:00:00.000', '2023-09-28/07:30:00.000'][0m
[35m[ZARR] [load_data] file_time_format=daily[0m
[35m[ZARR] [_find_zarr_paths] Called for data_type=mag_RTN_4sa, start_time=2023-09-28 06:00:00+00:00, end_time=2023-09-28 07:30:00+00:00, file_time_format=daily[0m
[35m[ZARR] [_get_zarr_path] Called for data_type=mag_RTN_4sa, timestamp=2023-09-28 00:00:00+00:00, file_time_format=daily[0m
[35m[ZARR] [_get_zarr_path] Returning path[0m
[35m[ZARR] [_find_zarr_paths] Returning paths: ['./data_cubby/mag_rtn_4sa/2023/09/28.zarr'][0m
[35m[ZARR] [load_data] zarr_paths: ['./data_cubby/mag_rtn_4sa/2023/09/28.zarr'][0m
[35m[ZARR] [load_data] Loading 1 Zarr stores[0m
[35m[ZARR] [load_data] Looping through zarr_paths[0m
[35m[ZARR] Zarr data not available for mag_RTN_4sa, proceeding with normal download...[0m
[35m[ZARR] Server mode for mag_RTN_4sa: dynamic[0m
[35m[ZARR] Attempting SPDF download (dynamic mode) for mag_RTN_4sa...[0m
Attempting SPDF download for mag_RTN_4sa in range ['2023-09-28/06:00:00.000', '2023-09-28/07:30:00.000']
Checking for Berkeley/SPDF case conflicts before SPDF download for mag_RTN_4sa...
Attempting SPDF check/download (no_update=False) for mag_rtn_4_sa_per_cyc...
[35m[ZARR] SPDF download result (dynamic mode) for mag_RTN_4sa: Success[0m
[35m[ZARR] [get_data] Calling import_data_function for mag_RTN_4sa[0m
Import data function called
Input trange: ['2023-09-28/06:00:00.000', '2023-09-28/07:30:00.000']

Importing data for UTC time range: ['2023-09-28/06:00:00.000', '2023-09-28/07:30:00.000']

=== Starting import for mag_RTN_4sa (CDF) ===
daterange called with start_date=2023-09-28 06:00:00+00:00, end_date=2023-09-28 07:30:00+00:00
End date has time component, using full day: 2023-09-28
Converted start_date to date: 2023-09-28
Will generate 1 dates
Yielding date: 2023-09-28
Found 1 unique CDF files to process.

Processing CDF file: psp_data/fields/l2/mag_rtn_4_per_cycle/2023/psp_fld_l2_mag_rtn_4_sa_per_cyc_20230928_v02.cdf
Successfully opened CDF file
Using time variable: epoch_mag_RTN_4_Sa_per_Cyc
File time range (TT2000): 749131269324447360 to 749217669114447616
Reading full time data array...
Read 395506 time points
Time indices: 98876 to 123595
Extracted 24719 time points within requested range

Reading variable: psp_fld_l2_mag_RTN_4_Sa_per_Cyc
Raw data shape: (24719, 3)
Successfully stored data slice for psp_fld_l2_mag_RTN_4_Sa_per_Cyc

Concatenating CDF data...
  Concatenated psp_fld_l2_mag_RTN_4_Sa_per_Cyc (Shape: (24719, 3))

Total CDF data points after concatenation: 24719
[35m[ZARR] [get_data] import_data_function returned: Success[0m
[35m[ZARR] Updating tracker for mag_RTN_4sa[0m
[35m[ZARR] [get_data] Calling update on mag_rtn_4sa with data_obj for mag_RTN_4sa[0m
[CUBBY] 
=== Update Debug ===
[CUBBY] Starting mag_rtn_4sa_class update...
[CUBBY] Stored all state: {}
[CUBBY] Stored br state: {}
[CUBBY] Stored bt state: {}
[CUBBY] Stored bn state: {}
[CUBBY] Stored bmag state: {}
[CUBBY] Stored pmag state: {}
Setting attribute: time with value: [749152869234641024 749152869453094272 749152869671723904 ...
 749158268555469568 749158268773922944 749158268992376192]
Setting attribute: datetime_array with value: ['2023-09-28T06:00:00.050641024' '2023-09-28T06:00:00.269094272'
 '2023-09-28T06:00:00.487723904' ... '2023-09-28T07:29:59.371469568'
 '2023-09-28T07:29:59.589922944' '2023-09-28T07:29:59.808376192']
self.datetime_array type after conversion: {type(self.datetime_array)}
First element type: {type(self.datetime_array[0])}
Setting attribute: field with value: [[ 569.81506 -146.06665  381.60696]
 [ 564.79956 -151.02687  385.5044 ]
 [ 560.3525  -155.20467  392.8169 ]
 ...
 [-657.7438   -91.57948 -104.28802]
 [-658.1075   -94.63475  -97.60503]
 [-654.5398   -75.47681 -136.6664 ]]
Setting attribute: raw_data with value: {'all': [array([ 569.81506,  564.79956,  560.3525 , ..., -657.7438 , -658.1075 ,
       -654.5398 ], dtype=float32), array([-146.06665, -151.02687, -155.20467, ...,  -91.57948,  -94.63475,
        -75.47681], dtype=float32), array([ 381.60696,  385.5044 ,  392.8169 , ..., -104.28802,  -97.60503,
       -136.6664 ], dtype=float32)], 'br': array([ 569.81506,  564.79956,  560.3525 , ..., -657.7438 , -658.1075 ,
       -654.5398 ], dtype=float32), 'bt': array([-146.06665, -151.02687, -155.20467, ...,  -91.57948,  -94.63475,
        -75.47681], dtype=float32), 'bn': array([ 381.60696,  385.5044 ,  392.8169 , ..., -104.28802,  -97.60503,
       -136.6664 ], dtype=float32), 'bmag': array([701.1766, 700.3009, 701.704 , ..., 672.2274, 672.0029, 672.9018],
      dtype=float32), 'pmag': array([195.62076, 195.13245, 195.91515, ..., 179.8012 , 179.68112,
       180.16212], dtype=float32)}

Debug - Data Arrays:
Time array shape: {self.time.shape}
Field data shape: (24719, 3)
First TT2000 time: 749152869234641024

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=all[0m
Setting attribute: all with value: [[ 569.81506  564.79956  560.3525  ... -657.7438  -658.1075  -654.5398 ]
 [-146.06665 -151.02687 -155.20467 ...  -91.57948  -94.63475  -75.47681]
 [ 381.60696  385.5044   392.8169  ... -104.28802  -97.60503 -136.6664 ]]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=br[0m
Setting attribute: br with value: [ 569.81506  564.79956  560.3525  ... -657.7438  -658.1075  -654.5398 ]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bt[0m
Setting attribute: bt with value: [-146.06665 -151.02687 -155.20467 ...  -91.57948  -94.63475  -75.47681]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bn[0m
Setting attribute: bn with value: [ 381.60696  385.5044   392.8169  ... -104.28802  -97.60503 -136.6664 ]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=bmag[0m
Setting attribute: bmag with value: [701.1766 700.3009 701.704  ... 672.2274 672.0029 672.9018]

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=mag_RTN_4sa, class=mag_rtn_4sa, subclass=pmag[0m
Setting attribute: pmag with value: [195.62076 195.13245 195.91515 ... 179.8012  179.68112 180.16212]
[CUBBY] Restoring saved state...
[CUBBY] Restored all state: {}
[CUBBY] Restored br state: {}
[CUBBY] Restored bt state: {}
[CUBBY] Restored bn state: {}
[CUBBY] Restored bmag state: {}
[CUBBY] Restored pmag state: {}
[CUBBY] === End Update Debug ===

[CUBBY] 
=== Stashing Debug (INSIDE DATA CUBBY)===
[CUBBY] Stashing with identifier: mag_rtn_4sa
[CUBBY] Attributes before stash:

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - all: [569.81506 564.79956 560.3525  557.4124  559.946   558.2307  559.819
 571.1426  567.93713 549.1548 ]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - bmag: [701.1766  700.3009  701.704   701.03827 702.6285  699.26056 700.49023
 700.9356  698.5389  703.3251 ]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - bn: [381.60696 385.5044  392.8169  392.78177 389.4663  390.8252  386.97443
 378.58786 385.09238 400.80646]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - br: [569.81506 564.79956 560.3525  557.4124  559.946   558.2307  559.819
 571.1426  567.93713 549.1548 ]...

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - bt: [-146.06665 -151.02687 -155.20467 -162.69144 -168.71068 -156.84209
 -165.95203 -147.574   -130.79701 -180.13713]...
[CUBBY] - calculate_variables: <bound method mag_rtn_4sa_class.calculate_variables of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>
[CUBBY] - datetime: []...
[CUBBY] - datetime_array: ['2023-09-28T06:00:00.050641024' '2023-09-28T06:00:00.269094272'
 '2023-09-28T06:00:00.487723904' '2023-09-28T06:00:00.706177152'
 '2023-09-28T06:00:00.924630528' '2023-09-28T06:00:01.143084032'
 '2023-09-28T06:00:01.361537152' '2023-09-28T06:00:01.579990656'
 '2023-09-28T06:00:01.798444160' '2023-09-28T06:00:02.016897280']...
[CUBBY] - field: [ 569.81506 -146.06665  381.60696  564.79956 -151.02687  385.5044
  560.3525  -155.20467  392.8169   557.4124 ]...
[CUBBY] - get_subclass: <bound method mag_rtn_4sa_class.get_subclass of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===


=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

[CUBBY] - pmag: [195.62076 195.13245 195.91515 195.5436  196.43173 194.55313 195.23798
 195.48633 194.15175 196.82141]...
[CUBBY] - raw_data: {'all': [array([ 569.81506,  564.79956,  560.3525 , ..., -657.7438 , -658.1075 ,
       -654.5398 ], dtype=float32), array([-146.06665, -151.02687, -155.20467, ...,  -91.57948,  -94.63475,
        -75.47681], dtype=float32), array([ 381.60696,  385.5044 ,  392.8169 , ..., -104.28802,  -97.60503,
       -136.6664 ], dtype=float32)], 'br': array([ 569.81506,  564.79956,  560.3525 , ..., -657.7438 , -658.1075 ,
       -654.5398 ], dtype=float32), 'bt': array([-146.06665, -151.02687, -155.20467, ...,  -91.57948,  -94.63475,
        -75.47681], dtype=float32), 'bn': array([ 381.60696,  385.5044 ,  392.8169 , ..., -104.28802,  -97.60503,
       -136.6664 ], dtype=float32), 'bmag': array([701.1766, 700.3009, 701.704 , ..., 672.2274, 672.0029, 672.9018],
      dtype=float32), 'pmag': array([195.62076, 195.13245, 195.91515, ..., 179.8012 , 179.68112,
       180.16212], dtype=float32)}
[CUBBY] - set_ploptions: <bound method mag_rtn_4sa_class.set_ploptions of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>
[CUBBY] - time: [749152869234641024 749152869453094272 749152869671723904
 749152869890177152 749152870108630528 749152870327084032
 749152870545537152 749152870763990656 749152870982444160
 749152871200897280]...
[CUBBY] - update: <bound method mag_rtn_4sa_class.update of <plotbot.data_classes.psp_mag_classes.mag_rtn_4sa_class object at 0x14751d310>>
[CUBBY] Stored in class_registry: mag_rtn_4sa
[CUBBY] === End Stashing Debug (LEAVING DATA CUBBY)===

Successfully updated and stored in data_cubby
[35m[ZARR] [get_data] Update completed for mag_rtn_4sa[0m
[35m[ZARR] [get_data] Calling store_data for mag_RTN_4sa[0m
[35m[ZARR] [store_data] Called for data_type=mag_RTN_4sa, trange=['2023-09-28/06:00:00.000', '2023-09-28/07:30:00.000'][0m
[35m[ZARR] Storing data for mag_RTN_4sa[0m
[35m[ZARR] datetime_array length: 24719[0m
[35m[ZARR] raw_data keys: ['all', 'br', 'bt', 'bn', 'bmag', 'pmag'][0m
[35m[ZARR] [store_data] file_time_format=daily[0m
[35m[ZARR] [store_data] Creating data_vars from class_instance.raw_data[0m
[STORE] var_name: br, data shape: (24719,), dims: ['time']
[STORE] var_name: bt, data shape: (24719,), dims: ['time']
[STORE] var_name: bn, data shape: (24719,), dims: ['time']
[STORE] var_name: bmag, data shape: (24719,), dims: ['time']
[STORE] var_name: pmag, data shape: (24719,), dims: ['time']
[STORE] datetime_array: ['2023-09-28T06:00:00.050641024' '2023-09-28T06:00:00.269094272'
 '2023-09-28T06:00:00.487723904' '2023-09-28T06:00:00.706177152'
 '2023-09-28T06:00:00.924630528'] ... total: 24719
[STORE] Dataset variables: ['br', 'bt', 'bn', 'bmag', 'pmag']
[35m[ZARR] [_get_zarr_path] Called for data_type=mag_RTN_4sa, timestamp=2023-09-28T06:00:00.050641024, file_time_format=daily[0m
[35m[ZARR] [_get_zarr_path] Returning path[0m
[35m[ZARR] Checking if Zarr file exists: True[0m
[35m[ZARR] Zarr directory contents: ['time', 'pmag', 'zarr.json', 'bt', 'bn', 'br', 'bmag'][0m
[35m[ZARR] [store_data] Data saved to Zarr store[0m
[35m[ZARR] [get_data] store_data result for mag_RTN_4sa: Success[0m
[CUBBY] 
=== Retrieving custom_class from data_cubby ===
[CUBBY] ✅ Successfully retrieved custom_class
[CUBBY] 
Plot Options for custom_class:
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: br
Returning br component
[CUBBY] 
=== Retrieving mag_rtn_4sa from data_cubby ===
[CUBBY] ✅ Successfully retrieved mag_rtn_4sa
[CUBBY] 
Plot Options for mag_rtn_4sa:
[94m[CUBBY] all plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='all', plot_type='time_series', var_name=['br_rtn_4sa', 'bt_rtn_4sa', 'bn_rtn_4sa, y_label='B (nT)', legend_label=['$B_R$', '$B_T$', '$B_N$'], color=['forestgreen', 'orange', 'dodgerblue'], y_scale='linear', y_limit=None, line_width=[1, 1, 1], line_style=['-', '-', '-'], colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bmag', plot_type='time_series', var_name='bmag_rtn_4sa', y_label='B (nT)', legend_label='|B|', color='k', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bn plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bn', plot_type='time_series', var_name='bn_rtn_4sa', y_label='B (nT)', legend_label='$B_N$', color='dodgerblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] br plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='br', plot_type='time_series', var_name='br_rtn_4sa', y_label='B (nT)', legend_label='$B_R$', color='forestgreen', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] bt plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='bt', plot_type='time_series', var_name='bt_rtn_4sa', y_label='B (nT)', legend_label='$B_T$', color='orange', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[94m[CUBBY] pmag plot options: data_type='mag_RTN_4sa', class_name='mag_rtn_4sa', subclass_name='pmag', plot_type='time_series', var_name='pmag_rtn_4sa', y_label='Magnetic\nPressure\n(nPa)', legend_label='$P_{mag}$', color='darkblue', y_scale='linear', y_limit=None, line_width=1, line_style='-', colormap='viridis', colorbar_scale='linear', colorbar_limits=None, additional_data=None, colorbar_label=None[0m
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

Getting subclass: bt
Returning bt component

=== Array Finalize Status ===
Finalizing array, obj type: <class 'numpy.ndarray'>
Copied plot state: {}
=== End Array Finalize Status ===

[35m[ZARR] Using plot_options: data_type=custom_data_type, class=custom_class, subclass=br_bt_add[0m
DEBUG custom_variable: Incoming expression for 'br_bt_add' already has data? True (24719 points)
Expression type: <class 'plotbot.plot_manager.plot_manager'>
Expression has source_var: True
Source var is None: False
Source var type: <class 'list'>
Source var length: 2
[CUBBY] 
=== Retrieving custom_class from data_cubby ===
[CUBBY] ✅ Successfully retrieved custom_class
[CUBBY] 
Plot Options for custom_class:
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

[CUBBY] 
=== Retrieving custom_class from data_cubby ===
[CUBBY] ✅ Successfully retrieved custom_class
[CUBBY] 
Plot Options for custom_class:
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===


DEBUG:
var: [ 423.7484   413.7727   405.14783 ... -749.32324 -752.74225 -730.0166 ]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2023-09-28T06:00:00.050641024
Time range: 2023-09-28T06:00:00.050641024 to 2023-09-28T07:29:59.808376192
var.data type: <class 'numpy.ndarray'>
var.data shape: (24719,)

Variable verification for custom_class.Mag_Sum_RT:
Plot attributes example:
- Color: None
- Y-label: Mag_Sum_RT
- Legend: Mag_Sum_RT
Setting title from plt.options: Test: Stardust Custom Arithmetic
🔵 PHASE 3: Verifying variable properties post-plotbot (stardust)
PASSED
tests/test_stardust.py::test_stardust_custom_numpy 🔵 PHASE 1: Creating numpy custom variable (stardust)

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {}
=== End Array Finalize Status ===

DEBUG custom_variable: Incoming expression for 'Abs_Bn' already has data? True (24719 points)
Expression type: <class 'plotbot.plot_manager.plot_manager'>
Expression has source_var: True
[CUBBY] 
=== Retrieving custom_class from data_cubby ===
[CUBBY] ✅ Successfully retrieved custom_class
[CUBBY] 
Plot Options for custom_class:
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

🔵 PHASE 2: Calling plotbot to trigger data load (stardust)
User explicitly set hspace to 0.25
User explicitly set hspace to 0.25

=== Array Finalize Status ===
Finalizing array, obj type: <class 'plotbot.plot_manager.plot_manager'>
Copied plot state: {'subclass_name': 'Abs_Bn', 'legend_label': 'Abs_Bn', 'class_name': 'custom_class', 'data_type': 'custom_data_type'}
=== End Array Finalize Status ===

[CUBBY] 
=== Retrieving custom_class from data_cubby ===
[CUBBY] ✅ Successfully retrieved custom_class
[CUBBY] 
Plot Options for custom_class:
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===

[CUBBY] 
=== Retrieving custom_class from data_cubby ===
[CUBBY] ✅ Successfully retrieved custom_class
[CUBBY] 
Plot Options for custom_class:
[CUBBY] === End Retrieval Debug (LEAVING DATA CUBBY)===


DEBUG:
var: [381.60696 385.5044  392.8169  ... 104.28802  97.60503 136.6664 ]
var type: <class 'plotbot.plot_manager.plot_manager'>
var.datetime_array type: <class 'numpy.ndarray'>
First element type: <class 'numpy.datetime64'>
First element: 2023-09-28T06:00:00.050641024
Time range: 2023-09-28T06:00:00.050641024 to 2023-09-28T07:29:59.808376192
var.data type: <class 'numpy.ndarray'>
var.data shape: (24719,)

Variable verification for custom_class.Abs_Bn:
Plot attributes example:
- Color: dodgerblue
- Y-label: Abs_Bn
- Legend: Abs_Bn
Setting title from plt.options: Test: Stardust Custom Numpy
🔵 PHASE 3: Verifying variable properties post-plotbot (stardust)
PASSED
tests/test_stardust.py::test_stardust_spdf_download_with_cleanup 🔵 PHASE 1: Initial Cleanup for mag_RTN_4sa (20181022)

--- Attempting cleanup for mag_RTN_4sa (20181022) ---
  Searching for files matching: /Users/robertalexander/GitHub/Plotbot/psp_data/fields/l2/mag_rtn_4_per_cycle/2018/psp_fld_l2_mag_rtn_4_sa_per_cyc_20181022_v*.cdf
  Found 1 file(s) to delete:
    Deleted: psp_fld_l2_mag_rtn_4_sa_per_cyc_20181022_v02.cdf
🔵 PHASE 2: Enable Debug Logging and First SPDF Call (mag_RTN_4sa)
Debug logging enabled: True
Calling download_spdf_data (1st time) with trange=['2018-10-22 06:00:00', '2018-10-22 18:00:00'], key='mag_RTN_4sa'
Attempting SPDF download for mag_RTN_4sa in range ['2018-10-22 06:00:00', '2018-10-22 18:00:00']
Checking for Berkeley/SPDF case conflicts before SPDF download for mag_RTN_4sa...
Attempting SPDF check/download (no_update=False) for mag_rtn_4_sa_per_cyc...
First call successful, returned path: psp_data/fields/l2/mag_rtn_4_per_cycle/2018/psp_fld_l2_mag_rtn_4_sa_per_cyc_20181022_v02.cdf
🔵 PHASE 3: Second SPDF Call for mag_RTN_4sa (expect local find)
Calling download_spdf_data (2nd time) with trange=['2018-10-22 06:00:00', '2018-10-22 18:00:00'], key='mag_RTN_4sa'
Attempting SPDF download for mag_RTN_4sa in range ['2018-10-22 06:00:00', '2018-10-22 18:00:00']
Checking for Berkeley/SPDF case conflicts before SPDF download for mag_RTN_4sa...
Attempting SPDF check/download (no_update=False) for mag_rtn_4_sa_per_cyc...
Second call successful, returned path: psp_data/fields/l2/mag_rtn_4_per_cycle/2018/psp_fld_l2_mag_rtn_4_sa_per_cyc_20181022_v02.cdf
PASSED

=============================== warnings summary ===============================
tests/test_stardust.py::test_stardust_plotbot_basic
tests/test_stardust.py::test_dynamic_mode_fallback_logic_integrated
tests/test_stardust.py::test_stardust_custom_arithmetic
  /Users/robertalexander/GitHub/Plotbot/plotbot/zarr_storage.py:216: UserWarning: Discarding nonzero nanoseconds in conversion.
    dt = pd.Timestamp(dt).to_pydatetime()

tests/test_stardust.py::test_stardust_plotbot_basic
tests/test_stardust.py::test_dynamic_mode_fallback_logic_integrated
tests/test_stardust.py::test_stardust_custom_arithmetic
  /opt/anaconda3/envs/plotbot_env/lib/python3.12/site-packages/zarr/api/asynchronous.py:205: UserWarning: Consolidated metadata is currently not part in the Zarr format 3 specification. It may not be supported by other zarr implementations and may change in the future.
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 12 passed, 6 warnings in 40.24s ========================
